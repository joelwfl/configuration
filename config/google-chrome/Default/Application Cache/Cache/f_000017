"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a){"use strict";var b,c=a._,d=a.window,e=a.Backbone,f=a.async,g=a.component,h=a.transition,i=a.console||{},j=a.jq||a.Zepto||a.jQuery,k="expires=Tue, 1 Jan 2025 01:01:01 GMT";e.$=j,e.Events.once=e.Model.prototype.once=e.Collection.prototype.once=e.View.prototype.once=e.Router.prototype.once=function(a,b,c){var d=this,e=function(){d.off(a,e),b.apply(c,arguments)};return this.on(a,e),this},b=a.APP=new(e.Model.extend(c.extend({},g,{STATE_ONLINE:0,STATE_OFFLINE:1,STATE_MAINTENANCE:2,STATE_UNSUPPORTED:3,STATE_DEPRECATED:4,defaults:{ready:!1,name:null,contentCdnUrl:null,gamesCdnUrl:null,basePathname:null,pushState:!1,online:c.has(d.navigator,"onLine")?d.navigator.onLine:!0,state:0,debug:!1,version:null,lang:null,langs:[],device:null,country:null,"legacy-browser":!1,search:{}},win:d,$win:j(d),doc:a.document,$doc:j(a.document),$:j,_:c,Backbone:e,async:f,transition:h,initialize:function(){var a=this;this.$doc.on("offline",function(){a.state()===a.STATE_ONLINE&&a.state(a.STATE_OFFLINE)}),this.$doc.on("online",function(){a.state()===a.STATE_OFFLINE&&a.state(a.STATE_ONLINE)}),this.on("change:state",function(){a.set("online",a.state()===a.STATE_ONLINE)}),this.on("change:lang",function(){if(a.get("ready")){var b=a.get("lang");try{a.doc.cookie="leolang="+b+"; path=/; "+k}catch(c){a.error(c,"app.js#initialize::on-change-lang")}a._.defer(function(){a.win.location="/"+b})}})},state:function(a,b){return c.isUndefined(a)||this.set({state:parseInt(a,10),stateMessage:b}),this.get("state")},log:function(){var d=-1!==(a.navigator&&a.navigator.userAgent||"").indexOf("MSIE"),e=function(a,c){b.get("debug")&&i&&i[a]&&(d?i[a](c):i[a].apply(i,c))},f=function(){return e("log",c.toArray(arguments)),b};return c.forEach(["log","dir","warn","error","time","timeEnd","group","groupEnd"],function(a){f[a]=function(){return e(a,c.toArray(arguments)),b}}),f}(),error:function(a,b,c){return this.trigger("error",this,a,b,c),this},track:function(a,b,c,d){return this.trigger("track",this,a,b,c,d),this},timing:function(a,b,c){return this.trigger("timing",this,a,b,c),this},filterComponents:function(a){var b=c.reduce(this._REGISTRY||{},function(b,c,d){return a(d,c)&&b.push(d),b},[]);return b},run:function(a){var b=this._,c=this.filterComponents(function(a){return 0===a.indexOf("init.")});return a&&this.once("ready",a),this.use(c,b.bind(function(){var a=this.get("pushState"),b=a&&this.get("lang")+"/";this.Backbone.history||(this.Backbone.history=new e.History),this.Backbone.History.started||this.Backbone.history.start({pushState:a,root:b}),this.trigger("ready",this),this.set("ready",!0)},this)),this}})))(a.CFG)}(this),function(a){"use strict";var b=a.APP,c=a.window.navigator||{},d=a.UAParser,e={};try{d(c.userAgent,e)}catch(f){}b.register("env",function(){return function(a,b){return b=b||{},d(a,b)}}),b.set("env",e)}(this),function(a){"use strict";var b=a.APP,c=b._;b.ERROR_CODES={2:"MAINTENANCE",3:"UNSUPPORTED",4:"DEPRECATED",2222:"EMAIL_TAKEN",2232:"NICKNAME_TAKEN",5404:"GAME_NOT_FOUND",6404:"NOT_FOUND_URL",6661:"TPCOOKIE_SET_FAILED",6662:"TPCOOKIE_CHECK_TIMEOUT",6663:"TPCOOKIE_INFO_DISABLED",7e3:"DEPOSIT_GENERIC",9994:"LOADING",9995:"UNAVAILABLE",9996:"MAINTENANCE",9997:"API_ERROR",9998:"OFFLINE",9999:"TIMEOUT",1e4:"GENERIC",10001:"INVALID_REQUEST_PARAMS",10002:"VALIDATION_ERROR",10003:"NOT_FOUND",10004:"EMAIL_TAKEN",10005:"EMAIL_BLOCKED",10006:"INVALID_REQUEST_CONTEXT",10007:"MOBILE_NUMBER_TAKEN",10008:"LOGIN_FAILED",10009:"ACCOUNT_NOT_VALIDATED",10010:"ACCOUNT_LOCKED_FOR_LOGIN",10011:"ACCOUNT_BLOCKED",10012:"CREATE_ACCOUNT_FAILED",10013:"INVALID_BIRTH_DATE",10014:"PASSWORD_VERIFICATION_FAILED",10015:"GAMING_LIMIT_EXCEEDED",10016:"NO_SUCH_USER_WITH_EMAIL",10017:"SESSION_EXPIRED",10018:"NOT_AUTHORIZED",10019:"MONEY_TRANSFER_DENIED",10020:"APPLICATION_SERVICE_ERROR",10021:"NICKNAME_CHANGE_FAILED",10022:"ACCOUNT_BLOCKED_BO",10023:"INVALID_VERIFICATION_CODE",10024:"ADDRESS_REQUIRED",10025:"MONEY_TRANSFER_PENDING"},b.ERROR=c.reduce(b.ERROR_CODES,function(a,b){return a[b]=b,a},{})}(this),function(a){"use strict";var b=a.APP,c=b.win,d=b.$,e=b._,f=c.navigator,g=c.location,h=c.setTimeout,i=c.clearTimeout,j=f.connection||f.mozConnection||f.webkitConnection||{},k=b.get("name"),l=b.get("loggerId"),m=250,n={application:k,environment:b.get("appEnv"),version:b.get("version"),userAgent:f.userAgent,bandwidth:j.bandwidth,lang:b.get("lang"),sid:null,user:null},o=c.ERRQ&&c.ERRQ.slice(0)||[],p=function(){var a=9999999,b=0,c=(new Date).toUTCString();return Math.floor(Math.random()*(a-b+1))+b+" - "+c},q=function(a,b,c){c&&(b=b||{},b.repeated=c);try{var f=e.extend({msgId:p(),type:a.toUpperCase(),url:g.href,message:b},n);d.ajax({type:"POST",url:"/api/log?"+d.param({source:k,project:l,sourcetype:"json_no_timestamp"}),contentType:"text/plain",data:JSON.stringify(f)})}catch(h){}},r=null,s=null,t=null,u=0,v=b.splunk=function(a,b){return r&&i(r),e.isEqual(a,t)&&e.isEqual(b,s)?u+=1:(t&&(q(t,s,u),u=0),t=a,s=b),r=h(function(){q(t,s,u),u=0,t=null,s=null},m),v};v.error=function(a,c,d,e){var f={};try{"string"==typeof c?(c=new Error(c),c.stack=null):c||(c=new Error('splunk.error, missing "err" argument'),c.stack=null),f={source:a,type:c.type,message:c.message,stack:c.stack,file:d,lineNum:e},b.log.error(c),b.log(c.stack)}catch(g){f={source:"splunk",message:g&&g.message||"Error while creating splunk error message"}}return v("ERROR",f),v},c.ERRQ={push:function(a){v.error("window",a[0],a[1],a[2])}},e.forEach(o,function(a){v.error("window",a[0],a[1],a[2])}),b.on("error",function(a,b,c,d){v.error("app",b,c,d)}),b.on("ready",function(){n.sid=b.get("sid"),n.env=b.get("env"),b.use("user",function(a){n.user=a.get("accountName"),a.on("change:accountName",function(){n.user=a.get("accountName")})})})}(this),function(a){"use strict";var b=a.APP;b.register("affiliate",["model.affiliate","user"],function(a,c){var d=b._,e=b.doc,f=function(a,c,f){var g,h,i,j,k=b.get("search")||{},l=new RegExp(c+"=([^;]+)");if("netReferMeta"===f){if(h=d.omit(k,a),d.isEmpty(h)&&!k.btag)try{h=JSON.parse((l.exec(e.cookie)||["null"]).pop())}catch(m){}}else{for(j=0,i=a.length;i>j;j++)if(g=a[j],d.has(k,g)){h=k[g];break}h||k.btag||(h=(l.exec(e.cookie)||[]).pop())}return h&&b.set(f,h),h},g=function(){var a=c.get("affiliate"),b=c.get("affiliatePID"),d=c.get("affiliateBID");h.build(a,b,d)},h=new a;return h.build(f(["btag"],"leobtag","netReferTag"),f(["pid"],"leonrpid","netReferPID"),f(["bid"],"leonrbid","netReferBID"),f(["btag","pid","bid"],"leonrmeta","netReferMeta")),c.on("login",function(){h.clear(),h.save(),g()}),c.on("logout",function(){h.clear(),h.save()}),b.on("ready",function(){c.isLoggedIn()&&g()}),h})}(this),function(a){"use strict";var b=a.APP;b.register("api-cache",["cache"],function(a){var c=b._,d={"POST user/contact":["GET user/contact"],"POST user/settings":["GET user/settings"],"PUT user/limits":["GET user/limits"],"DELETE user/paymentcontracts":["GET user/paymentcontracts","GET payment/deposit","GET payment/withdrawal"],"POST payment/deposit":["GET user/metrics","GET user/transactions","GET user/paymentcontracts","GET payment/deposit","GET payment/withdrawal"],"POST payment/withdrawal":["GET user/metrics","GET user/transactions","GET payment/withdrawal"],"DELETE payment/withdrawal":["GET user/metrics","GET user/transactions"],"DELETE auth":["GET user","GET user/contact","GET user/settings","GET user/limits","GET user/transactions","GET user/paymentcontracts"],USER:["GET user","GET user/metrics","GET user/transactions","GET user/limits"],GAME_PLAY:["GET user","GET user/metrics","GET user/transactions","GET user/limits"]},e=new a("local",{"GET custom/personalinfo":null,"GET cms/about":86400,"GET cms/bonuses":86400,"GET news":3600,"GET faq":86400}),f=new a("session",{"GET user":null,"GET user/contact":null,"GET user/metrics":300,"GET user/settings":null,"GET user/limits":null,"GET user/transactions":600,"GET user/paymentcontracts":null,"GET payment/deposit":null,"GET payment/withdrawal":null}),g=function(a,b){var c=(b.match(/^\/api\/v2\/([a-z]+\/?[^\/?]+)/i)||[""]).pop();return a.toUpperCase()+" "+c.toLowerCase()},h=function(a){return c.has(e.buckets,a)?e:c.has(f.buckets,a)?f:void 0},i={get:function(a){var b=a.url,c=g(a.type,b),d=h(c);return d&&d.get(c,b)},set:function(a,b){var e=a.url,f=g(a.type,e),i=h(f);return c.has(d,f)&&this.clear(d[f]),i&&i.set(f,e,b),this},clear:function(a){return c.isArray(a)?c.forEach(a,function(a){e.clear(a),f.clear(a)}):(e.clear(a),f.clear(a)),this},clearUser:function(){this.clear(d.USER)},clearGamePlay:function(){this.clear(d.GAME_PLAY)}};return i})}(this),function(a){"use strict";var b=a.APP;b.register("api-core",["api-cache"],function(a){var c=b.$,d=b._,e=b.win,f=b.Backbone,g={create:"POST",update:"PUT","delete":"DELETE",read:"GET"},h=3e4,i=function(){return d.reduce(["lang","country","device"],function(a,c){return b.has(c)&&(a[c]=b.get(c)),a},{})},j=null,k="X-CSRF-Token",l=function(f,g,h,m){h=h||function(){},g=d.defaults(g||{},l.defaultOptions),g.type=g.type.toLowerCase(),"post"===g.type||"put"===g.type?(g.headers={"Content-Type":"application/json"},j&&(g.headers[k]=j),g.data="string"==typeof g.data?g.data:JSON.stringify(g.data)):g.data&&(g.params=d.extend(g.params||{},g.data),g.data=null);var n,o,p=(new Date).getTime(),q=d.defaults(g.params||{},i()),r=!1;return g.url=f+"?"+c.param(q),-1===g.url.indexOf(l.url)&&(g.url=l.url+("/"===g.url[0]?g.url:"/"+g.url)),n=a.get(g),b.log("API_CACHE",g.type,g.url,n),n&&!g.force?(d.defer(function(){b.timing("api-request",f,(new Date).getTime()-p),h.call(m||e,null,n.data,n.meta,n)}),r=!0):g.force||b.state()===b.STATE_ONLINE?(g.params=null,d.extend(g,{cache:!1,dataType:"text",complete:function(c,d){b.log("API()::complete",d);var i,n;try{i=c.responseText&&JSON.parse(c.responseText)||{}}catch(o){i={}}("success"!==i.status||"success"!==d)&&(i.code||(i.code="timeout"===d?9999:1e4),n=new Error(b.ERROR_CODES[i.code]||b.ERROR.API_ERROR)),n?(n.message===b.ERROR.SESSION_EXPIRED||n.message===b.ERROR.NOT_AUTHORIZED)&&l.trigger("death-by-server",l,n):(a.set(g,i),j=c.getResponseHeader(k)||j,b.timing("api-request",f,(new Date).getTime()-p)),h.call(m||e,n,i.data,i.meta,i)}}),c.ajax(g)):(o=new Error(b.ERROR_CODES[b.state()]||b.ERROR.OFFLINE),b.error(o,"API::"+g.url),d.defer(function(){h.call(m||e,o)})),r};return l.defaultOptions={timeout:h,type:"get"},d.extend(l,b.Backbone.Events,{cache:a,contextParams:i,url:"/api/v2"}),f.sync=function(a,b,c){c=c||{};var e=d.isFunction(b.url)?b.url():b.url,f=c.data,h=c.success,i=c.error,j=c.mute;return f||!b||"create"!==a&&"update"!==a||(f=b.toJSON()),c.url&&(e+="/"+c.url),l(e,{type:g[a],data:f},function(a,b,c,d){a?i(a):h(j?{}:d)})},l})}(this),function(a){"use strict";var b=a.APP;b.register("api",["api-core","api-cache"],function(a,b){return a.clearCache=function(){b.clear("*")},a.clearCacheUser=function(){b.clearUser()},a.clearCacheGamePlay=function(){b.clearGamePlay()},a.login=function(b,c,d,e){a("auth",{type:"post",data:{email:b,password:c}},function(b,c,f){d&&d.call(e,b,c,f),b?a.trigger("auth:error",this,b,c,f):a.trigger("auth:success",this,c,f)})},a.logout=function(b,c){a("auth",{type:"delete"},function(d,e,f){b&&b.call(c,d,e,f),d?a.trigger("logout:error",this,d,e,f):a.trigger("logout:success",this,e,f)})},a.signup=function(b,c,d){a("signup",{type:"post",data:b},function(b,e,f){c&&c.call(d,b,e,f),b?a.trigger("signup:error",this,b,e,f):a.trigger("signup:success",this,e,f)})},a.personalInfo=function(b,c,d){a("custom/personalInfo",{data:{idNumber:b}},c,d)},a.isEmailAddressAvailable=function(b,c,d){a("custom/isEmailAddressAvailable",{type:"get",data:{email:b}},c,d)},a.isNicknameAvailable=function(b,c,d){a("custom/isNicknameAvailable",{type:"get",data:{nickname:b}},c,d)},a.getGameRulesUrl=function(b,c,d){a("rules/"+b,{type:"get",data:null},c,d)},a.setNickName=function(b,c,d){a("user/nickname",{type:"post",data:b},c,d)},a.checkIfPhoneNumberExists=function(b,c,d,e){a("custom/checkIfPhoneNumberExists",{type:"get",data:{phonePrefix:b,phoneNumber:c}},d,e)},a.changePassword=function(b,c,d){a("user/password",{type:"post",data:b},c,d)},a.sessionKeepalive=function(b,c){a("keepalive",null,b,c)},a.lostPassword=function(b,c,d){a("custom/lostPassword",{type:"post",data:{email:b}},c,d)},a.resetPassword=function(b,c,d,e,f){a("custom/resetPassword",{type:"post",data:{email:b,token:c,password:d}},function(b,c,d){e&&e.call(f,b,c,d),b?a.trigger("auth:error",this,b,c,d):a.trigger("auth:success",this,c,d)})},a.getAddressesByPostcode=function(b,c,d){a("custom/addresses",{data:{postcode:b}},c,d)},a.getAddressById=function(b,c,d){a("custom/addresses/"+b,null,c,d)},a.tag=function(b,c,d){a("tag",{type:"post",data:b},c,d)},a})}(this),function(a){"use strict";var b=a.APP;b.register("bootstrap",["api"],function(a){var c=b._,d=null,e=b.get("debug"),f=function(a,c){var d=(c||{})[b.get("lang")];a.message===b.ERROR.MAINTENANCE?b.state(b.STATE_MAINTENANCE,d):a.message===b.ERROR.DEPRECATED?b.state(b.STATE_DEPRECATED,d):a.message===b.ERROR.UNSUPPORTED?b.state(b.STATE_UNSUPPORTED,d):b.state(b.STATE_OFFLINE),b.log.warn(a)},g=function(a,b){var c=(a||"").split("."),d=(b||"").split(".");return e||c[0]===d[0]&&c[1]===d[1]},h=!1,i=function(e){b.log("Bootstrapping application...");var i={force:!0},j=b.get("search");c.has(j,"country")&&(i.params={country:j.country}),h?e&&b.once("bootstrap",function(a,b,c){e(b,c)}):(h=!0,a("bootstrap",i,function(a,i){i=i||{};var j=i.context||{},k={online:!0,contentCdnUrl:i.contentCdnUrl||"",gamesCdnUrl:i.gamesCdnUrl||"",basePathname:i.basePathname||"",pushState:!1,device:j.device,country:j.country,currency:j.currency||"EUR"},l=[],m=i.settings&&i.settings.categories||{};a||(g(b.get("version"),i.version)?i.context?i.context.device?i.context.country||(a=new Error('Missing bootstrap parameter "context.country"')):a=new Error(b.ERROR.UNSUPPORTED):a=new Error('Missing bootstrap parameter "context"'):a=new Error(b.ERROR.DEPRECATED)),a?f(a,i):(b.state(b.STATE_ONLINE),c.forEach(i.settings||[],function(a,d){c.has(k,d)||b.has(d)||(k[d]=a)}),c.map(i.gameCategories,function(a,b){var c=m[a]||{};l[b]={name:a,weight:c.weight||i.gameCategories.length-b,rows:c.count||i.settings.defaultCategoryCount||3}}),k.categories=l,b.set(k)),d=i,h=!1,b.trigger("bootstrap",b,a,i),e&&e(a,i)}))};return i.state=function(){return d&&!c.isEmpty(d)},i.data=function(a){return d&&d[a]},i})}(this),function(a){"use strict";var b=a.APP;b.register("cache",["storage"],function(a){var c=b._,d=function(b,c){this._storage=a[b],this.buckets=c};return d.prototype={_useBrowserStorage:null,_storage:null,_cacheKey:"cache",buckets:null,version:b.get("version"),clear:function(b,d){var e=this._storage,f=this._cacheKey;return d&&"*"!==b?d&&e.remove(this.getKey(b,d)):c.forEach(e.keys(),function(b){0===b.indexOf(a.buildKey(f+":"))&&e.remove(b)}),this},get:function(a,b){var c=(new Date).getTime(),d=1e3*(this.buckets[a]||c),e=this._storage.get(this.getKey(a,b)),f=!1;return e&&c-e.time<d&&e.version===this.version?f=e.data:this.clear(a,b),f},getKey:function(b,d,e){return c.has(this.buckets,b)?(e?a.buildKey(this._cacheKey):this._cacheKey)+":"+b+":"+d:null},set:function(a,b,d){var e={version:this.version,time:(new Date).getTime(),data:d};return c.has(this.buckets,a)?c.isUndefined(d)||c.isNull(d)?(this.clear(a,b),this):(this._storage.set(this.getKey(a,b),e),this):this}},d})}(this),function(a){"use strict";var b=a.APP;b.register("cms",["collection.cms"],function(a){var b=new a;return b})}(this),function(a){"use strict";var b=a.APP;b.register("collection.cms",["collection","model.cms","api"],function(a,b,c){var d=a.extend({model:b,url:c.url+"/cms"});return d})}(this),function(a){"use strict";var b=a.APP;b.register("collection.deposit-methods",["collection","model.payment-method"],function(a,c){var d=(b._,a.extend({model:c,url:"/api/v2/payment/deposit/methods"}));return d})}(this),function(a){"use strict";var b=a.APP;b.register("collection.faq",["collection","model.faq"],function(a,b){var c=a.extend({model:b,url:"/api/v2/faq",comparator:function(a){return a.get("sortIndex")||0}});return c})}(this),function(a){"use strict";var b=a.APP;b.register("collection.games",["collection","model.game"],function(a,c){var d=b._,e=a.extend({model:c,url:"/api/v2/game/_all",_categories:null,initialize:function(){this.setCategories(this.options.categories)},setCategories:function(a){return this._categories=a||[],this},getCategories:function(){return this._categories},byCategory:function(a){return this.toCollection("filter",function(b){var c=d.keys(b.get("categories")||{});return-1!==d.indexOf(c,a.name||a)})},byHasRules:function(){return this.toCollection("filter",function(a){var b=a.get("attrs")||{};return b.hasRules})},categorize:function(a){var b={},c=this;return c.toJSON&&d.isFunction(c.toJSON)&&(c=c.toJSON()),d.each(c,function(a){var c=a,e=c.categories;d.forEach(e,function(a,d){(b[d]||(b[d]=[])).push(c)})}),a&&d.isFunction(a)?d.each(b,function(c,d){b[d]=a(c,d)}):a&&d.isString(a)?d.each(b,function(c,e){b[e]=d.sortBy(c,a)}):d.each(b,function(a,c){b[c]=a.sort(function(a,b){return a.categories[c]===b.categories[c]?a.name>b.name?1:-1:b.categories[c]-a.categories[c]})}),b},getTopCategory:function(){var a=this;return d.reduce(this.getCategories(),function(b,c){return!b.weight||b.weight<c.weight&&a.byCategory(c.name).length>0?c:b},{})},getWeightedCategories:function(){var a=this;return d.chain(this.getCategories()).sortBy(function(a){return-a.weight}).filter(function(b){return a.byCategory(b.name).length>0}).pluck("name").value()},getRowsInCategory:function(a){var b=a.name||a;return d.reduce(this.getCategories(),function(a,c){return c.name===b?c.rows:a},1)},getGameById:function(a){var b=this.get(a);return b||(b=this.find(function(b){return-1!==d.indexOf((b.get("attrs")||{}).legacy||[],a)})),b},getFavorites:function(){return this.where({favorite:!0})},search:function(a){var b=[];return a&&(a=a.toLowerCase(),b=this.filter(function(b){return-1!==b.get("name").toLowerCase().indexOf(a)})),b}});return e})}(this),function(a){"use strict";var b=a.APP;b.register("collection",["model","storage"],function(a,c){var d=b._,e=b.Backbone,f=e.Collection.prototype,g=e.Collection.extend({model:a,constructor:function(a,b){this.options=d.extend(this.options||{},b||{}),this.options.url&&(this.url=this.options.url),this.options.cacheKey&&(d.isEmpty(a)&&(a=this._loadFromCache()),this._startWatching()),e.Collection.call(this,a,b)},_cacheStore:c.local,_loadFromCache:function(){var a,c;return this._cacheStore&&this._cacheStore.has(this.options.cacheKey)&&(a=this._cacheStore.get(this.options.cacheKey),a.version===b.get("version")?c=a.models:this._cacheStore.remove(this.options.cacheKey)),c},_saveToCache:d.debounce(function(){this._cacheStore&&this.options.cacheKey&&this._cacheStore.set(this.options.cacheKey,{version:b.get("version"),models:this.toJSON()})},200),_startWatching:function(){this.on("add",this._saveToCache,this),this.on("remove",this._saveToCache,this),this.on("change",this._saveToCache,this),this.on("reset",this._saveToCache,this)},_stopWatching:function(){this.off("add",this._saveToCache,this),this.off("remove",this._saveToCache,this),this.off("change",this._saveToCache,this),this.off("reset",this._saveToCache,this)},parse:function(a){return a&&"success"===a.status&&a.data},reverse:function(){return this.models.reverse(),this},getWhere:function(a){return this.where(a).shift()},setWhere:function(a){return this.where(a).shift()},getMany:function(a,b){var c=d.map(a,function(a){this.get(a)},this);return b&&b.asCollection?new this.constructor(c):c},toCollection:function(a){var b=Array.prototype.slice.call(arguments,1),c=this[a].apply(this,b);return new this.constructor(c)},orderBy:function(a,b){var c=this.models.slice(0);return d.forEach(a,function(a){c.sort("function"==typeof arg?a:function(b,c){var d,e;return"function"==typeof b[a]?(d=b[a](),e=c[a]()):"undefined"!=typeof b[a]?(d=b[a],e=c[a]):(d=b.get(a),e=c.get(a)),e>d?-1:d>e?1:0})}),new this.constructor(b&&b.asCollection?c:c)},fetchModel:function(a,b,c){var e=this.get(a);return e?(d.defer(function(){b.call(c,null,e)}),!0):(this.add({id:a}),e=this.get(a),e.fetch({error:function(a,d){b.call(c,d,a)},success:function(){b.call(c,null,e)}}))},fetch:function(a){a=a||{};var b=a.success;return b&&(a.success=function(a,c,d){b(a,c.data,c.meta,d)}),f.fetch.apply(this,arguments)}});return g})}(this),function(a){"use strict";var b=a.APP;b.register("collection.limits",["collection","model.limit"],function(a,b){var c=a.extend({model:b,url:"/api/v2/user/limits"});return c})}(this),function(a){"use strict";{var b=a.APP;b._}b.register("collection.news",["collection","model.news"],function(a,b){var c=a.extend({url:"/api/v2/news",model:b,comparator:function(a){return-new Date(a.get("published")).getTime()}});return c})}(this),function(a){"use strict";var b=a.APP;b.register("collection.payment-contracts",["collection","model.payment-contract"],function(a,b){var c=a.extend({model:b,url:"/api/v2/user/paymentcontracts"});return c})}(this),function(a){"use strict";var b=a.APP;b.register("collection.promotions",["collection","model.promotion"],function(a,b){var c=a.extend({TYPE_WELCOME:1,TYPE_HOME:2,TYPE_DEPOSIT:3,TYPE_SIGNUP:4,TYPE_SIDEBAR:5,AUTH_LOGGED_IN:1,AUTH_LOGGED_OUT:2,AUTH_SIGNUP:3,url:"/api/v2/promotions",model:b,comparator:function(a){return a.get("sortIndex")||0}});return c})}(this),function(a){"use strict";var b=a.APP;b.register("collection.transactions",["collection","model.transaction"],function(a,b){var c={game:10,account:5},d=a.extend({pageSize:function(){return c[this.options.type]||5},model:b,url:function(){return"game"===this.options.type?"/api/v2/user/transactions/game":"deposit"===this.options.type?"/api/v2/user/transactions/deposit":"/api/v2/user/transactions/account"}});return d})}(this),function(a){"use strict";var b=a.APP;b.register("collection.withdrawal-methods",["collection","model.payment-method"],function(a,c){var d=(b._,a.extend({model:c,url:"/api/v2/payment/withdrawal/methods"}));return d})}(this),function(a){"use strict";var b=a.APP;b.register("games",["collection.games","storage","bootstrap"],function(a,c,d){var e=b._,f="latest-games",g="favorites-games",h=new a(d.data("games"),{categories:b.get("categories")}),i=function(){var a=c.local.get(f)||{};h.forEach(function(b){var c,d=a[b.id];d&&(c=b.get("categories")||{},c.played=d,b.set({categories:c,played:d}))})},j=function(){var a=e.sortBy(h.filter(function(a){return!!a.get("played")}),function(a){return a.get("played")}),b=e.reduce(a.reverse().slice(0,20),function(a,b){return b.has("played")&&(a[b.id]=b.get("played")),a},{});c.local.set(f,b)},k=function(){var a=c.local.get(g)||[];h.forEach(function(b){-1!==e.indexOf(a,b.id)&&b.set("favorite",!0)})},l=function(){var a=e.map(h.filter(function(a){return!!a.get("favorite")}),function(a){return a.id});c.local.set(g,a)};return b.on("bootstrap",function(a,b){b||(h.reset(d.data("games")),h.setCategories(a.get("categories")))}),i(),h.on("reset",i),h.on("change:played",j),k(),h.on("reset",k),h.on("change:favorite",l),h})}(this),function(a){"use strict";var b=a.APP;b.register("i18n",["storage"],function(a,c){var d,e=b._,f=(b.win,b.$),g="[≈",h="≈]",i="i18n:",j=new RegExp("^[A-Z][A-Z0-9_\\-]+$"),k="ERROR_",l=b.get("langFiles")||{},m=function(a,b){var c=l[a];c?(b=b||function(){},f.ajax({url:"/api"+c,dataType:"json",error:function(a,c,d){b(d)},success:function(a){b(null,a)}})):b(null,{})},n=function(a,c,f){var i=d[a];return i?c&&e.forEach(c,function(a,b){i=f&&f.all?i.replace(new RegExp(b,"g"),a):i.replace(b,a)}):(i=g+a+h,b.splunk.error("i18n",a)),i};n.isMessageKey=function(a){return j.test(a)},n.error=function(a,c){var d;return d=a.message?n.error(a.message,c):n.isMessageKey(a)&&0!==a.indexOf(k)?n(k+a,c):e.has(b.ERROR_CODES,a)?n(k+b.ERROR_CODES[a],c):n(a,c)},n.hasMessages=function(){return!e.isEmpty(d)},n.loadMessages=function(c,f){var g,h,j=(new Date).getTime();f=f||function(){},g=a.local.get(i+c.toLowerCase())||{},g.version===b.get("version")&&(h=g.messages),h&&!b.get("debug")?(d=h||{},e.defer(function(){b.timing("i18n","load",(new Date).getTime()-j),f()})):m(c,function(e,g){e&&f(e),d=g||{},a.local.set(i+c.toLowerCase(),{version:b.get("version"),messages:g}),b.timing("i18n","load",(new Date).getTime()-j),f()})},b.on("change:lang",function(){n.loadMessages(b.get("lang"),function(){b.view.render()})}),n.loadMessages(b.get("lang"),function(){c(n)})})}(this),function(a){"use strict";var b=a.APP;b.register("init.3rdparty",["loader"],function(a){var c=b.doc.location.protocol,d=function(){var d="https://d7p9czrvs14ne.cloudfront.net/11/eum/rum.js",e=("https:"===c?"https://ssl":"http://www")+".google-analytics.com/ga.js";a.js(d,function(a){a&&b.splunk.error("init.3rdparty",a,d)}),a.js(e,function(a){a&&b.splunk.error("init.3rdparty",a,e)})},e=function(){b.state()===b.STATE_ONLINE&&(d(),b.off("change:state",e))};b.state()===b.STATE_ONLINE?d():b.on("change:state",e)})}(this),function(a){"use strict";var b=a.APP;b.register("init.appcache",function(){var a=b.win,c=b.doc,d=b._,e=a.applicationCache&&a.applicationCache.status||0,f=b.get("env"),g=[function(){return 0===e},function(){return"webkit"===f.browserEngine},function(){return"android"!==f.platformName||f.platformVersion>=4.2},function(){return"ios"!==f.platformName||f.platformVersion<7||f.platformVersion>=8}],h=function(){var a=c.createElement("iframe");a.src="/manifest.html",a.style.position="absolute",a.style.left="-1000px",a.style.top="-1000px",c.body.appendChild(a)};d.all(g,function(a){return a()})&&h()})}(this),function(a){"use strict";var b=a.APP;b.register("init.error",["i18n","router"],function(a,c){var d=(b.$win,b.$,b._),e=function(){c.navigate("",{trigger:!0,replace:!0})},f=function(a,b){var c=typeof b;"string"==typeof a&&(a=new Error(a)),"undefined"===c?g(a):"function"===c&&b(a)},g=function(c){if(b.get("ready")){var f=c.message||"INFO_GENERIC_ERROR";f.match(/^[A-Z\-_]+$/)&&(f=a.error(f)),0===f.indexOf("[≈")&&(f=a("INFO_GENERIC_ERROR")),b.view?(b.view.hideLoading(),b.view.errorOverlayMessage(f,e)):e()}else b.once("ready",function(){d.defer(g,c)})};return c.on("error",function(a,c,d){b.splunk.error("router",c,'ROUTE: "'+d.url+'"'),f(c)}),c.on("route:not-found",function(c,d){b.splunk.error("route",b.ERROR.NOT_FOUND_URL,'ROUTE: "'+d.url+'"'),f(a.error(b.ERROR.NOT_FOUND_URL,{"{{url}}":d.url}))}),b.on("error",function(a,b,c){f(b,c)}),f})}(this),function(a){"use strict";var b=a.APP;b.register("init.fastclick",function(){var a=b.win.FastClick;b.$(function(){a.attach(b.doc.body)})})}(this),function(a){"use strict";var b=a.APP;b.register("init.routes",["init.router-mixins"],function(a,c){var d=b.filterComponents(function(a){return 0===a.indexOf("route.")}),e=[b.win.location.protocol,b.win.location.host].join("//");b.$doc.on("click","a:not([rel=external])",function(b){var c,d=[this.protocol,this.host].join("//");e===d?(c=this.hash&&this.hash.substr(1),b.isDefaultPrevented()||a.navigate(c,{trigger:!0}),b.preventDefault()):this.target="blank"}),b.use(d,c)})}(this),function(a){"use strict";var b=a.APP;b.register("init.webapp",function(){var a=b.win,c=a.navigator,d=a.location,e=b.get("lang"),f=b.get("staticUrl");c.mozApps&&c.mozApps.install&&b.on("ready",function(){var a=d.protocol+"//"+d.host+f+"/webapp/manifest-"+e+".webapp",g=c.mozApps.getSelf(),h=function(){var d=c.mozApps.install(a);d.onsuccess=function(){b.track("webapp","installed")},d.onerror=function(){b.error(d.error.name,"init.setup#webapp::install")}};g.onsuccess=function(){g.result||h()},g.onerror=function(){b.error(g.error.name,"init.setup#webapp::request")}})})}(this),function(a){"use strict";var b=a.APP;b.register("livechat",["model","loader","i18n","user","storage","string-helpers"],function(c,d,e,f,g,h){a.LC_API||(a.LC_API={}),a.__lc||(a.__lc={});var i=(b.win,b._),j="livechat_hasActiveSession",k={licenseKey:2949702,url:"https://secure.livechatinc.com/licence/{licenseKey}/open_chat.cgi",defaultChatGroupId:1},l={leomobile_EN:{id:1},leodesktop_EN:{id:2},leomobile_SV:{id:3},leodesktop_SV:{id:4},leomobile_NO:{id:5},leodesktop_NO:{id:6},leomobile_FI:{id:7},leodesktop_FI:{id:8},leomobile_NL:{id:9},leodesktop_NL:{id:10},leomobile_DE:{id:11},leodesktop_DE:{id:12},leomobile_AU:{id:13},leodesktop_AU:{id:14}},m=function(){var a=b.get("app").replace("-","")+"_"+b.get("lang").toUpperCase(),c=l[a]||{id:k.defaultChatGroupId};return c.id},n=c.extend({initialize:function(){this._updateVars(),this.on("change",this._updateVars,this),this.listenTo(f,"login",this._updateVars),this.listenTo(f,"logout",this.clear)},_updateVars:function(){this.set({name:f.get("firstName")||this.get("name")||("leo-mobile"===b.get("app")?e("INFO_CHAT_DEFAULT_NAME"):""),email:this.get("email")||f.get("email")||"",accountName:f&&f.isLoggedIn()?f.get("accountName"):"",vipLevel:f.get("vipLevel")||""})},alreadyEngaged:function(){return g.session.get(j)},engage:function(a){return g.session.set(j,!!a),this},getChatUrl:function(){var a="&params=",b=this.attributes,c=k.url.replace("{licenseKey}",k.licenseKey)+"?groups="+m()+"&name="+h.capitaliseFirstLetter(this.get("name"));return i.forEach(b,function(b,c){c&&"name"!==c&&b&&(a+=c+"%3D"+b+"%26")
}),this.engage(!0),c+a}});return new n})}(this),function(a){"use strict";var b=a.APP;b.register("loader",function(){var a=b._,c=b.win.Image,d=b.doc,e=function(){},f=b.win.setTimeout,g=b.win.clearTimeout,h=3e4,i=function(a){a=a||e;var c=f(function(){(a=e)(new Error(b.ERROR.TIMEOUT))},h);return function(b){g(c),a(b)}},j=function(c){return function(d,e){return e=i(e),b.state()!==b.STATE_ONLINE?a.defer(e,new Error(b.ERROR.OFFLINE)):c(d,e),k}},k={image:j(function(a,e){var f=(new Date).getTime(),g=new c,h=(-1===a.indexOf("http")?b.get("staticUrl"):"")+a;g.onload=function(){g.parentNode.removeChild(g),b.timing("loader",a,(new Date).getTime()-f),e()},g.onerror=function(){g.parentNode.removeChild(g),e(new Error(b.ERROR.LOADING))},g.src=h,d.body.appendChild(g)}),js:j(function(a,c){var e=(new Date).getTime(),f=d.getElementsByTagName("script")[0],g=d.createElement("script"),h=(-1===a.indexOf("http")?b.get("staticUrl"):"")+a;"undefined"!=typeof g.onreadystatechange?g.onreadystatechange=function(){var a=g.readyState;("loaded"===a||"complete"===a)&&c()}:(g.onload=function(){g.parentNode.removeChild(g),b.timing("loader",a,(new Date).getTime()-e),c()},g.error=function(){g.parentNode.removeChild(g),c(new Error(b.ERROR.LOADING))}),g.src=h,f.parentNode.appendChild(g)}),css:j(function(c,e){if(e=i(e),b.state()!==b.STATE_ONLINE)return a.defer(e,new Error(b.ERROR.OFFLINE)),this;var f=d.getElementsByTagName("head")[0],g=d.createElement("link"),h=b.get("staticUrl")+c;g.rel="stylesheet",g.type="text/css",g.href=h,f.appendChild(g),a.defer(e)})};return k})}(this),function(a){"use strict";var b=a.APP;b.register("model.affiliate",["model"],function(a){var c=(b._,b.doc),d=(b.get("affiliates")||{},a.extend({initialize:function(){},exists:function(){return!this.isNew()},build:function(a,c,d,e){b.log("AffiliateModel::build",a,c,d,e);var f=a&&a.split("_").shift();return f?this.set({id:f,btag:a,pid:c,bid:d,meta:e}):this.clear(),this},_setCookie:function(a,b,d){b||(b="",d="Thu, 01 Jan 1970 00:00:01 GMT"),c.cookie=a+"="+b+"; path=/; expires="+(d||"")},save:function(){if(this.id)try{var a,c=new Date;c.setTime(c.getTime()+3888e6),a=c.toUTCString(),this._setCookie("leobtag",this.get("btag"),a),this._setCookie("leonrpid",this.get("pid"),a),this._setCookie("leonrbid",this.get("bid"),a),this._setCookie("leonrmeta",this.has("meta")?JSON.stringify(this.get("meta")):null,a)}catch(d){b.error(d,"model.affiliate.js#save1")}else try{this._setCookie("leobtag"),this._setCookie("leonrpid"),this._setCookie("leonrbid"),this._setCookie("leonrmeta"),this._setCookie("NRBtag"),this._setCookie("NRAffiliateId")}catch(d){b.error(d,"model.affiliate.js#save2")}}}));return d})}(this),function(a){"use strict";var b=a.APP;b.register("model.auth",["model","validate"],function(a,c){var d=(b.$,b._,a.extend({url:function(){return"/api/v2/auth"},defaults:{id:"session",email:null,password:null},validators:{email:{ERROR_EMPTY:c.notEmpty,ERROR_INVALID_PASSWORD:c.email},password:{ERROR_EMPTY:c.notEmpty,ERROR_INVALID_PASSWORD:c.password}},parse:function(){return null}}));return d})}(this),function(a){"use strict";var b=a.APP;b.register("model.cms",["model"],function(a){var b=a.extend({urlRoot:"/api/v2/cms",defaults:{id:null,title:null,body:null,published:null,sortIndex:null}});return b})}(this),function(a){"use strict";var b=a.APP;b.register("model.deposit-form",["model","validate","user"],function(a,c,d){var e=(b.$,b._,"Leo Vegas"),f=a.extend({defaults:{creditCardHolder:null,creditCardNumber:null,validThru:null,creditCardValidationNumber:null,amount:null},validators:{creditCardNumber:{ERROR_INVALID_CREDIT_CARD_NUMBER:function(a){return c.creditCardVisa(a)||c.creditCardMasterCard(a)}},validThru:{ERROR_INVALID_VALID_THRU:c.validThru},creditCardValidationNumber:{ERROR_INVALID_CREDIT_CARD_VALIDATION_NUMBER:c.creditCardValidationNumber}},initialize:function(){this._setCardHolder()},_setCardHolder:function(){this.set("creditCardHolder",d?d.getFullName():e)}});return f})}(this),function(a){"use strict";var b=a.APP;b.register("model.faq",["model","validate"],function(a){var b=a.extend({defaults:{id:null,title:null,question:null,answer:null,sortIndex:0,tags:[]}});return b})}(this),function(a){"use strict";var b=a.APP;b.register("model.game",["model","validate","api"],function(a,c,d){var e="/themes/leovegas_theme_default.jpg",f=[32,57,62],g=a.extend({urlRoot:"/api/v2/games",defaults:{id:null,name:null,description:null,categories:{},attrs:{},imageFolder:null,desktopTheme:null,state:1},initialize:function(){this.on("change:imageFolder",this._setImages,this),this._setImages(),this.on("change:played",this._setPlayedCategory,this),this._setTint()},_setPlayedCategory:function(){var a=this.get("categories"),b=this.get("played");a.played=b,this.set("categories",a)},_imageUrl:function(a){var c=this.get("imageFolder"),d=b.get("gamesCdnUrl");return d&&c?d+c+"/"+a+".jpg":b.get("staticUrl")+"/game-images/"+a+".jpg"},_setImages:function(){var a={mobileSmall:this._imageUrl("150x150"),desktop:this._imageUrl("426x324"),mobileLarge:this._imageUrl("640x280"),theme:this.has("desktopTheme")?b.get("gamesCdnUrl")+this.get("desktopTheme"):b.get("staticUrl")+e};this.set("images",a)},_setTint:function(){var a=(this.get("attrs")||{}).tint||{};a.theme||(a.theme=f.slice(0)),this.set("tint",a)},fetchPlayData:function(a,b){var c=this.url()+(a?"/play":"/playforfun");return d(c,null,function(a,c){a||(a=this.validate(c),a||this.set(c)),b&&b(a,c)},this),this}});return g})}(this),function(a){"use strict";var b=a.APP;b.register("model",["storage"],function(a){var c=b._,d=b.Backbone,e=d.Model.prototype,f=d.Model.extend({constructor:function(a,b){this.options=c.extend(this.options||{},b||{}),this.options.url&&(this.url=this.options.url),this.options.cacheKey&&(c.isEmpty(a)&&(a=this._loadFromCache()),this._startWatching()),this.validators||(this.validators={}),d.Model.call(this,a,b)},_cacheStore:a.local,_loadFromCache:function(){var a,c;return this._cacheStore&&this._cacheStore.has(this.options.cacheKey)&&(a=this._cacheStore.get(this.options.cacheKey),a.version===b.get("version")?c=a.attributes:this._cacheStore.remove(this.options.cacheKey)),c},_removeFromCache:function(){this._cacheStore&&c.has(this._cacheStore,this.options.cacheKey)&&this._cacheStore.remove(this.options.cacheKey)},_saveToCache:c.debounce(function(){this._cacheStore&&this.options.cacheKey&&this._cacheStore.set(this.options.cacheKey,{version:b.get("version"),attributes:this.attributes})},200),_startWatching:function(){this.on("change",this._saveToCache,this),this.on("destroy",this._removeFromCache,this)},_stopWatching:function(){this.off("change",this._saveToCache,this),this.off("desipose",this._removeFromCache,this)},validate:function(a,b){if(c.isEmpty(this.validators)||b&&b.silent)return!1;var d,e,f=!1;return c.isString(a)?(d=a,a={},a[d]=2===arguments.length?b:this.get(d)):arguments.length||(a=this.attributes),e=c.reduce(a,function(a,b,d){var e,g=this.validators[d];for(e in g)if(c.has(g,e)&&!g[e].call(this,b)){f=!0,a[d]=new Error(e);break}return a},{},this),f?e:!1},save:function(a,b,d){var f,g;return c.isObject(a)||null===a||void 0===a?(f=a,d=b):(f={},f[a]=b),d=c.extend({validate:!0},d),this._validate(f,d)?(g=d.success,g&&(d.success=function(a,b,c){g(a,b.data,b.meta,c)}),e.save.call(this,f,d)):!1},pick:function(){var a=c.toArray(arguments);return a.unshift(this.attributes),c.pick.apply(c,a)},omitNonDefaults:function(a){return c.pick(a||this.attributes,c.keys(this.defaults))},parse:function(a){return a&&(a.data||a)},changedKeys:function(a){var b=c.keys(this.changedAttributes()||{});return a&&0!==a.length&&(b=c.intersection(b,a)),b},toJSON:function(){var a=d.Model.prototype.toJSON.apply(this,arguments);return c.forEach(a,function(b,c){b&&"function"==typeof b.toJSON&&(a[c]=b.toJSON())}),a},fetch:function(a){a=a||{};var d=a.success;return d&&(a.success=function(a,b,c){d(a,b.data,b.meta,c)}),a.data=c.extend(a.data||{},b.context),e.fetch.apply(this,arguments)}});return f})}(this),function(a){"use strict";var b=a.APP;b.register("model.limit",["model","validate","string-helpers","i18n","user"],function(a,c,d,e,f){var g=b._,h={loss_current:"currentWeekLossLimit",loss_remaining:"remainingWeekLossLimit",loss_future:"futureWeekLossLimit",loss_futureDate:"futureWeekLossLimitDate",turnover_current:"currentWeekTurnoverLimit",turnover_remaining:"remainingWeekTurnoverLimit",turnover_future:"futureWeekTurnoverLimit",turnover_futureDate:"futureWeekTurnoverLimitDate",time_current:"currentSessionLimit",time_remaining:"remainingSessionLimit",time_future:"futureSessionLimit",time_futureDate:"futureSessionLimitDate"},i="session",j=a.extend({url:function(){return"/api/v2/user/limits/"+this.id},defaults:{id:null,current:-1,remaining:-1,future:-1,futureDate:null},validators:{current:{ERROR_INVALID_AMOUNT:c.number,ERROR_LIMIT_TOO_LOW:function(a){var b=!0;return this.id!==i&&(b=-1===a||a>=(f.getLimitMinAmount("minLimit")||Number.MAX_VALUE)),b},ERROR_LIMIT_TOO_HIGH:function(a){var b=this.previous("current");return b?0>=b||b>=a:!0}},future:{ERROR_INVALID_AMOUNT:c.number,ERROR_LIMIT_TOO_LOW:function(a){var b=!0;return a<this.get("current")&&a>0?b=!1:this.id!==i&&(b=-1===a||a>=(f.getLimitMinAmount("minLimit")||Number.MAX_VALUE)),b}}},initialize:function(){this.on("change:futureDate",this._setFormattedDate,this),this._setFormattedDate(),this.on("change",function(a){var b=a.id||"",c=a.changedAttributes();g.forEach(c||[],function(a,c){h[b+"_"+c]&&f.set(h[b+"_"+c],a)})})},_setFormattedDate:function(){var a,b=this.get("futureDate");b&&(a=d.dateFromIsoString(b),this.set("formattedDate",d.formatDate(a,f.get("country"))))},getOptions:function(){var a=[];return this.id===i&&(a.push({value:-1,label:"OPTION_SESSION_LIMIT_DEFAULT"}),g.each([1,2,4,8,16],function(b){a.push({value:b,label:"OPTION_SESSION_LIMIT_"+b})})),a},format:function(a){var b,c;return this.id===i?(c=g.find(this.getOptions(),function(b){return b.value.toString()===a.toString()}),b=c&&e(c.label)):b=d.formatMoney(a,f.get("currency"),!0),b}});return j})}(this),function(a){"use strict";var b=a.APP;b.register("model.news",["model.cms","validate","i18n","string-helpers","user"],function(a,c,d,e,f){var g=f.get("country")||b.get("country")||"SE",h=a.extend({url:"/api/v2/news",initialize:function(){this.on("change:published",this._setDatePublished,this),this._setDatePublished()},destroy:function(){this.off("change:published",this._setDatePublished,this)},_setDatePublished:function(){var a=this.get("published"),b=e.dateFromIsoString(a),c=new Date,f=e.formatDate(b,g);b&&b.getUTCFullYear()===c.getFullYear()&&b.getUTCMonth()===c.getUTCMonth()&&b.getUTCDate()===c.getUTCDate()?f=d("LABEL_TODAY"):b&&b.getUTCFullYear()===c.getFullYear()&&b.getUTCMonth()===c.getUTCMonth()&&b.getUTCDate()===c.getUTCDate()-1&&(f=d("LABEL_YESTERDAY")),this.set("datePublished",f)}});return h})}(this),function(a){"use strict";var b=a.APP;b.register("model.payment-contract",["model","validate","i18n"],function(a){var c=b._,d=["VISA","MC"],e=a.extend({urlRoot:"/api/v2/user/paymentcontracts",defaults:{id:null,type:null,displayName:null,combinedName:null},initialize:function(){this._setDisplayName(),this.on("change:type change:displayName",this._setDisplayName,this)},_setDisplayName:function(){var a=(this.get("type")||"").toUpperCase(),b=this.get("displayName");-1!==c.indexOf(d,a)&&(b=a+" "+b),this.set("combinedName",b,{silent:!0})}});return e})}(this),function(a){"use strict";var b=a.APP;b.register("model.payment-method",["model","validate","collection.payment-contracts"],function(a,b,c){var d=a.extend({url:"/api/v2/payment",defaults:{id:null,name:null,minAmount:null,maxAmount:null,supportsPaymentByContract:null,contracts:[],images:[],quickAmounts:[]},_images:{adyencard:["visa","mc"],adyenwithdraw:["visa","mc"],instantbank:["trustly"],paysafecard:["paysafecard"],ticketsurf:["visa"],ticketsurfmobile:["visa"],ideal:["ideal"],idealmobile:["ideal"],dccard:["visa","mc"]},initialize:function(){this._setContracts(),this.on("change:contracts",this._setContracts,this),this._setImages(),this.on("change:name",this._setImages,this),this._sortQuickAmounts(),this.on("change:quickAmounts",this._sortQuickAmounts,this)},_setContracts:function(){var a=this.get("contracts");a instanceof c||(a=new c(a),this.set("contracts",a,{silent:!0}))},_sortQuickAmounts:function(){this.get("quickAmounts").sort(function(a,b){return b-a})},_setImages:function(){var a=this.get("name");a&&this.set("images",this._images[a]||[a])},validators:{id:{ERROR_EMPTY:b.notEmpty},name:{},minAmount:{ERROR_EMPTY:b.number},maxAmount:{ERROR_EMPTY:b.number},supportsPaymentByContract:{ERROR_NOT_BOOLEAN:function(){return!0}},contracts:{}}});return d})}(this),function(a){"use strict";var b=a.APP;b.register("model.promotion",["model"],function(a){var c=a.extend({TYPE_WELCOME:1,TYPE_HOME:2,TYPE_DEPOSIT:3,TYPE_SIGNUP:4,TYPE_SIDEBAR:5,AUTH_LOGGED_IN:1,AUTH_LOGGED_OUT:2,AUTH_ALL:3,_TYPES:{welcome:1,home:2,deposit:3,signup:4,sidebar:5},_AUTH_TYPES:{loggedIn:1,loggedOut:2,all:3},defaults:{id:null,type:null,loggedIn:!1,title:null,text:null,imageFolder:null,button:null,action:null,sortIndex:0},initialize:function(){this.on("change:imageFolder",this._setImages,this),this._setImages()},_imageUrl:function(a,c){var d=this.get("imageFolder"),e=b.get("contentCdnUrl");return e&&d?e+d+"/"+a+(c||".jpg"):b.get("staticUrl")+"/img/promotions/"+a+(c||".jpg")},_setImages:function(){var a={mobileHome:this._imageUrl("640x280"),mobileWelcome:this._imageUrl("640x280"),mobileSignup:this._imageUrl("640x280"),mobileDeposit:this._imageUrl("306x90",".png"),mobileSidebar:this._imageUrl("520x300"),desktopHome:this._imageUrl("430x280"),desktopWelcome:this._imageUrl("430x280"),desktopSidebar:this._imageUrl("260x200"),desktopSidebarDeposit:this._imageUrl("306x90",".png")};this.set("images",a)},isOfType:function(a){return this.get("type")===this._TYPES[a]},isOfAuthType:function(a){var b=this.get("auth");return a?b===this.AUTH_LOGGED_IN||b===this.AUTH_ALL:b===this.AUTH_LOGGED_OUT||b===this.AUTH_ALL}});return c})}(this),function(a){"use strict";var b=a.APP;b.register("model.session",["model","storage"],function(a,b){var c=a.extend({_cacheStore:b.session});return c})}(this),function(a){"use strict";var b=a.APP;b.register("model.signup",["model.session","validate","string-helpers","affiliate","api"],function(a,c,d,e,f){var g=b.get("lang"),h=b.get("country"),i=b._,j=(a.prototype,b.win.setTimeout,b.win.clearTimeout,a.extend({urlRoot:"/api/v2/signup",defaults:{email:null,password:null,firstName:null,lastName:null,gender:"M",birthDate:null,addressStreet:null,addressCity:null,addressZip:null,mobileNumber:null,mobileNumberPrefix:null,wantNewsletter:!0,wantSms:!0,country:h,language:g,netReferTag:null,netReferPID:null,netReferBID:null,netReferMeta:null},validators:{email:{ERROR_EMPTY:c.notEmpty,ERROR_INVALID_EMAIL:c.email},password:{ERROR_EMPTY:function(a){return this.get("storedPassword")?!0:c.notEmpty(a)},ERROR_INVALID_PASSWORD:function(a){return this.get("storedPassword")?!0:this.get("email")!==a?c.password(a):void 0}},firstName:{ERROR_EMPTY:c.name},lastName:{ERROR_EMPTY:c.name},gender:{ERROR_GENDER:function(a){return"M"===a||"F"===a}},birthDate:{ERROR_INVALID_BIRTH_DATE:c.birthDate},addressStreet:{ERROR_EMPTY:c.notEmpty},addressZip:{ERROR_EMPTY:c.notEmpty},addressCity:{ERROR_EMPTY:c.notEmpty},country:{ERROR_EMPTY:c.notEmpty},language:{ERROR_EMPTY:c.notEmpty},mobileNumber:{ERROR_MOBILE_NUMBER:c.mobile},mobileNumberPrefix:{ERROR_EMPTY:c.notEmpty},verification:{ERROR_EMPTY:c.notEmpty}},options:{changeSaveTimeout:5e3},initialize:function(){this.set({netReferTag:e.get("btag"),netReferPID:e.get("pid"),netReferBID:e.get("bid"),netReferMeta:e.get("meta")}),this._changeKeys=i.chain(this.validators).keys().without("password").value(),this.once("sync",function(){this.on("change",i.throttle(this._saveOnChange,this.options.changeSaveTimeout),this)},this)},_saveOnChange:function(){var a=this.changedKeys(this._changeKeys);this.id&&0!==a.length&&this.save(null,{validate:!1,mute:!0})},parse:function(a){return a&&(a.data||a)},validateStep:function(a){var b=this.pick(this.options.stepKeys["step"+a]);return this.validate(b)},hasChangedInStep:function(a){var b=this.changedKeys(this.options.stepKeys["step"+a]);return b},getBirthDate:function(){var a=this.get("birthDate");return d.dateFromIsoString(a)},register:function(a){var b=this;a=a||{},f("signup/"+this.attributes.id+"/register",{data:this.toJSON(),type:"PUT"},function(c,d,e){c?a.error(b,c):a.success(b,d,e)})}}));return j})}(this),function(a){"use strict";var b=a.APP;b.register("model.support",["model","validate"],function(a,b){var c=a.extend({url:"/api/v2/support",defaults:{email:null,tag:null,message:null},tagPrefix:"cat_",categories:["games","payment","account","bonuses","tech","suggestions","gamelimit","other"],validators:{email:{ERROR_INVALID_EMAIL:b.email},tag:{ERROR_EMPTY:b.notEmpty},message:{ERROR_EMPTY:b.notEmpty}}});return c})}(this),function(a){"use strict";var b=a.APP;b.register("model.transaction",["model","validate","string-helpers","user"],function(a,c,d,e){var f=b._,g=e.get("country")||b.get("country")||"SE",h=["PENDINGFEE"],i=["WITHDRAWALPENDING_CANCELED","PENDINGFEE_CANCELED"],j="Fee",k=a.extend({defaults:{type:null,id:null,state:null,date:null,"in":null,out:null,channel:null,currency:null,refId:null,refType:null,refName:null,refDetails:null},iconRefTypeMap:{Deposit:"icon-download-alt",WithdrawalPending:"icon-upload-alt",BonusRelease:"icon-gift",PendingFee:"icon-exchange"},iconStateMap:{Complete:"icon-ok-circle",Canceled:"icon-minus-sign",Pending:"icon-time"},initialize:function(){this.on("change:refType",this._setRefTypeIcon,this),this._setRefTypeIcon(),this.on("change:state",this._setStateIcon,this),this._setStateIcon(),this.on("change:date",this._setFormattedDate,this),this._setFormattedDate(),this._setFeeRefName(),this._setAmountToZero()},_setRefTypeIcon:function(){var a=this.get("refType");this.set("refTypeIcon",this.iconRefTypeMap[a])},_setStateIcon:function(){var a=this.get("state");this.set("stateIcon",this.iconStateMap[a])},_setFeeRefName:function(){-1!==f.indexOf(h,(this.get("refType")||"").toUpperCase())&&this.set("refName",j)},_setAmountToZero:function(){-1!==f.indexOf(i,(this.get("refType")+"_"+this.get("state")).toUpperCase())&&(this.set("in",0),this.set("out",0))},_setFormattedDate:function(){var a=d.dateFromIsoString(this.get("date"));this.set({formattedDate:d.formatDate(a,g),formattedTime:d.formatTime(a),month:a.getMonth()+1})}});return k})}(this),function(a){"use strict";var b=a.APP;b.register("model.user-contact",["model","validate","user"],function(a,b){var c=a.extend({url:"/api/v2/user/contact",defaults:{street:null,zip:null,city:null,mobileNumberPrefix:null,mobileNumber:null},initialize:function(){},validators:{street:{ERROR_EMPTY:b.notEmpty},zip:{ERROR_EMPTY:b.notEmpty},city:{ERROR_EMPTY:b.notEmpty},mobileNumberPrefix:{ERROR_EMPTY:b.notEmpty},mobileNumber:{ERROR_MOBILE_NUMBER:b.mobile}},isAddressComplete:function(){var a=this.pick(["street","zip","city"]);return this.validate(a)===!1}});return c})}(this),function(a){"use strict";var b=a.APP;b.register("model.user-exclude",["model","validate","user"],function(a,c){var d=b._,e=[{value:"1",label:"LABEL_PAUSE_ACCOUNT_ONE_DAY",months:0,days:1,finite:!0},{value:"2",label:"LABEL_PAUSE_ACCOUNT_ONE_WEEK",months:0,days:7,finite:!0},{value:"3",label:"LABEL_PAUSE_ACCOUNT_ONE_MONTH",months:1,days:0,finite:!0},{value:"4",label:"LABEL_PAUSE_ACCOUNT_TWO_MONTHS",months:2,days:0,finite:!0},{value:"5",label:"LABEL_PAUSE_ACCOUNT_SIX_MONTHS",months:6,days:0,finite:!0}],f=[{value:"-2",label:"LABEL_PAUSE_ACCOUNT_TEMPORARY",months:-1,days:-1,finite:!1}],g=[{value:"-1",label:"LABEL_PAUSE_ACCOUNT_PERMANENT",months:-1,days:-1,finite:!1}],h=a.extend({url:function(){return"/api/v2/user/exclusions/"+this.id},defaults:{duration:null,reason:"REASON_1",password:null},_reasons:[{value:"REASON_1",label:"LABEL_PAUSE_ACCOUNT_REASON_1",durations:d.union(e,f)},{value:"REASON_2",label:"LABEL_PAUSE_ACCOUNT_REASON_2",durations:g},{value:"REASON_3",label:"LABEL_PAUSE_ACCOUNT_REASON_3",durations:d.union(e,f)},{value:"REASON_4",label:"LABEL_PAUSE_ACCOUNT_REASON_4",durations:d.union(e,f)},{value:"REASON_5",label:"LABEL_PAUSE_ACCOUNT_REASON_5",durations:d.union(e,f)},{value:"REASON_6",label:"LABEL_PAUSE_ACCOUNT_REASON_6",durations:d.union(e,f)}],validators:{duration:{ERROR_EMPTY:c.notEmpty},reason:{ERROR_EMPTY:c.notEmpty},password:{ERROR_EMPTY:c.notEmpty,ERROR_INVALID_PASSWORD:c.password}},initialize:function(){this._setDuration(),this.on("change:duration",this._setDuration,this),this._setReason(),this.on("change:reason",this._setReason,this)},_setDuration:function(){var a=this.getDuration(),b=new Date;this.isFiniteDuration()?a&&(b.setUTCMonth(b.getUTCMonth()+a.months),b.setUTCDate(b.getUTCDate()+a.days)):b.setUTCFullYear(b.getUTCFullYear()+50),this.set({durationDate:b,durationLabel:a&&a.label})},getDuration:function(){var a=this.get("duration");return d.find(this.getDurations(),function(b){return b.value===a})},_setReason:function(){var a=this.getReason();this.set({reasonLabel:a&&a.label})},isFiniteDuration:function(){var a=this.getDuration();return a?a.finite:!1},getDurations:function(){var a=this.getReason();return a?a.durations:[]},getReasons:function(){return this._reasons},getReason:function(){var a=this.get("reason");return d.find(this.getReasons(),function(b){return b.value===a})},sync:function(b,c,d){return d=d||{},("create"===b||"update"===b)&&(d.data={blockedEnd:this.get("durationDate"),blockedReason:this.get("reason"),password:this.get("password")}),a.prototype.sync.call(this,b,this,d)}});return h})}(this),function(a){"use strict";var b=a.APP;b.register("model.user-reality-check",["model","validate"],function(a){var c=(b._,a.extend({url:"/api/v2/user/reality-check",defaults:{realityCheck:!1}}));return c})}(this),function(a){"use strict";var b=a.APP;b.register("model.user-settings",["model","validate"],function(a,c){var d=(b._,a.extend({url:"/api/v2/user/settings",defaults:{bonus:!0,wantSms:!1,wantEmail:!1},validators:{bonus:{ERROR_NOT_EMPTY:function(a){return c.notEmpty(a)}}}}));return d})}(this),function(a){"use strict";var b=a.APP;b.register("model.user",["model","validate","api","storage"],function(a,c,d,e){var f={REASON_1:"LABEL_PAUSE_ACCOUNT_REASON_1",REASON_2:"LABEL_PAUSE_ACCOUNT_REASON_2",REASON_3:"LABEL_PAUSE_ACCOUNT_REASON_3",REASON_4:"LABEL_PAUSE_ACCOUNT_REASON_4",REASON_5:"LABEL_PAUSE_ACCOUNT_REASON_5",REASON_6:"LABEL_PAUSE_ACCOUNT_REASON_6"},g="login",h="user:login",i=b._,j=a.extend({url:"/api/v2/user",defaults:{email:null,accountName:null,nickName:null},validators:{email:{ERROR_EMPTY:c.notEmpty,ERROR_INVALID_EMAIL:c.email},accountName:{ERROR_EMPTY:c.notEmpty,ERROR_INVALID_EMAIL:c.email},password:{ERROR_EMPTY:c.notEmpty,ERROR_INVALID_PASSWORD:c.password}},initialize:function(){if(this._setFullBalance(),this._setFullPendingWithdrawalSum(),this.on("change:balance change:bonus",this._setFullBalance,this),this.on("change:pendingWithdrawalSum change:pendingWithdrawalFeeSum",this._setFullPendingWithdrawalSum,this),!this.has("accountName")){var a=e.local.get(g);a&&this.set("accountName",a,{silent:!0})}},_setFullBalance:function(){this.set("fullBalance",(this.get("balance")||0)+(this.get("bonus")||0))},_setFullPendingWithdrawalSum:function(){this.set("fullPendingWithdrawalSum",(this.get("pendingWithdrawalSum")||0)+(this.get("pendingWithdrawalFeeSum")||0))},getFullName:function(){return this.get("firstName")+" "+this.get("lastName")},getLimitMinAmount:function(a){var c=0,d=b.get("minCurrencyAmounts");return d&&d[a]&&(c=d[a][this.get("currency")]||c),c},loginWithResponse:function(a,c,d,h){if(d=d||{},!a){var i=this.parse(c)||c;a=this.validate(i),a||(this.set(i),this.setLoginTime(),e.local.set(g,this.get("accountName")))}return a?a.message===b.ERROR.ACCOUNT_LOCKED_FOR_LOGIN?this.trigger("login:locked",this,d):a.message===b.ERROR.ACCOUNT_BLOCKED?c&&f[c.reason]&&c.date?this.trigger("login:paused",this,{reason:f[c.reason],toDate:new Date(c.date)},d):this.trigger("login:blocked",this,d):this.trigger("login:error",this,a,d):this.isLoggedIn()&&(this.trigger("login:success",this,d),e.local.set(g,this.get("accountName")),this.setLoginTime()),h&&h(a,c,d),this.trigger("login",this,a,d),a},setNickName:function(a,b){var c=this;return d.setNickName({nickname:a},function(d,e,f){d||c.set("nickName",a),b&&b(d,e,f)})},login:function(a,b,c,e){return d.login(a,b,function(a,b,d){var f=i.defaults({},d,e);this.loginWithResponse(a,b,f,c)},this)},getLoginTime:function(){return e.local.get(h)||0},setLoginTime:function(a){return a=a||(new Date).getTime(),e.local.set(h,a),this},logout:function(a){var b=this.get("accountName");return d.logout(function(c,d,e){this.clear({silent:!0}),b&&this.set("accountName",b,{silent:!0}),this.trigger("change",this),a&&a(c,d,e),this.setLoginTime(null),this.trigger("logout",this,c,e||{})},this)},fetchMetrics:function(a,b){return b=b||null,d("user/metrics",b,function(b,c,d){b||(b=this.validate(c),b||this.set(c)),a&&a(b,c,d)},this)},isLoggedIn:function(){return!this.isNew()},isVIP:function(){var a=b.get("vipLevelLimit");return i.isNumber(a)?this.get("vipLevel")>=a:!1},hasLowBalanceForGame:function(a){var b=a&&a.get("noBonus"),c=(this.get("currency"),this.get("balance")),d=this.getLimitMinAmount("noBonusLimit")||5;return this.isLoggedIn()&&b?d>c:!1},getLowLimits:function(){var a=["Loss","Turnover"],b=[],c=this.getLimitMinAmount("lowWeekLimit")||10,d=this;return i.forEach(a,function(a){var e={type:a.toLowerCase()},f=d.get("remainingWeek"+a+"Limit")||null;f&&c>f&&(e.remainingLimit=f,b.push(e))}),b}});return j})}(this),function(a){"use strict";var b=a.APP;b.register("payment",["api","user","string-helpers"],function(a,c,d){var e=b._,f=(b.get("env"),0===b.get("name").indexOf("leo-desktop")),g=!0,h={ADYEN_CARD:"adyencard",ADYEN_WITHDRAW:"adyenwithdraw",PAYSAFECARD:"paysafecard",INSTANTBANK:"instantbank",EBANKING:"ebanking",IDEAL:"ideal",NETELLER:"neteller",MONEYBOOKERS:"moneybookers",DIRECT_EBANKING:"directEbanking",DCCARD:"dccard"},i=e.extend({},b.Backbone.Events,{METHOD:h,BAD_ERRORS:[b.ERROR.GENERIC,b.ERROR.APPLICATION_SERVICE_ERROR],DEPOSIT_METHODS:[h.ADYEN_CARD,h.PAYSAFECARD,h.INSTANTBANK,h.EBANKING,h.IDEAL,h.NETELLER,h.MONEYBOOKERS,h.DIRECT_EBANKING,h.DCCARD],WITHDRAWAL_METHODS:[h.ADYEN_WITHDRAW,h.INSTANTBANK,h.NETELLER,h.MONEYBOOKERS,h.DCCARD],RESPONSE_TYPE:{NAVIGATE:"navigate",REDIRECT:"redirect",IFRAME:"iframe"},_deposit:function(d,h,j){if(-1===e.indexOf(i.DEPOSIT_METHODS,d))return e.defer(j,new Error("UNSUPPORTED_PAYMENT_METHOD")),i;h.restrictedThirdPartyCookies=!g;var k=this,l="payment/deposit";return a(l,{type:"post",data:h},function(a,g){var h,i;a?a.message===b.ERROR.MONEY_TRANSFER_DENIED?(a=null,h=k.RESPONSE_TYPE.NAVIGATE,i="payment/deposit/"+d+"/result/failed"):a.message===b.ERROR.MONEY_TRANSFER_PENDING?(a=null,h=k.RESPONSE_TYPE.NAVIGATE,i="payment/deposit/"+d+"/result/pending"):(b.error(a,"payment.js#PAYMENT.deposit::callback"),-1!==e.indexOf(k.BAD_ERRORS,a.message)&&(a=new Error(b.ERROR.DEPOSIT_GENERIC))):g.extraData?f?(h=k.RESPONSE_TYPE.IFRAME,i=g.extraData):(h=k.RESPONSE_TYPE.NAVIGATE,i="payment/deposit/"+d+"/result/failed"):g.redirectUrl?(b.get("debug")&&-1!==e.indexOf([k.METHOD.IDEAL,k.METHOD.EBANKING],d)&&(g.redirectUrl+="&countryCode="+c.get("country")),h=k.RESPONSE_TYPE.REDIRECT,i=g.redirectUrl):(h=k.RESPONSE_TYPE.NAVIGATE,i="payment/deposit/"+d+"/result/success"),j(a,h,i)}),this},deposit:function(a,b,c,d){return this._deposit(a,{methodId:b,amount:c},d)},depositWithCard:function(a,b,c,e,f){var g={methodId:b,amount:c,card:d.removeWhitespaces(e.number),validThru:e.validThru,cvv:e.cvv,cardHolder:e.holder};return this._deposit(a,g,f)},depositWithReference:function(a,b,c,d,e){var f={methodId:b,amount:c,paymentContractId:d};return this._deposit(a,f,e)},depositWithReferenceAndCVV:function(a,b,c,d,e,f){var g={methodId:b,amount:c,paymentContractId:d,cvv:e};return this._deposit(a,g,f)},withdraw:function(b,c,d,e){var f=this;a("payment/withdrawal",{type:"post",data:{methodId:b,amount:c,paymentContractId:d}},function(a,b){return a?void e(a):b.redirectUrl?e(null,f.RESPONSE_TYPE.REDIRECT,b.redirectUrl):void e(null,f.RESPONSE_TYPE.navigate)})},cancelPendingWithdrawal:function(b){a("payment/withdrawal/pending",{type:"delete"},function(a){b(a)})},getWithdrawalFee:function(){var a=b.get("withdrawalFee"),d=a?a[c.get("currency")]:0,f=e.isNumber(d)?d:0;return c.isVIP()?0:f}});return b.isRegistered("3pc-support")&&b.use("3pc-support",function(a){g=!!a}),i})}(this),function(a){"use strict";var b=a.APP;b.register("promotions",["collection.promotions","bootstrap"],function(a,c){var d=new a(c.data("promotions"));return b.on("bootstrap",function(){d.reset(c.data("promotions"))}),d})}(this),function(a){"use strict";var b=a.APP||{};b.register("router",function(){var a=b._,c=b.Backbone,d=a.extend({},c.Events,{_nsRoutes:{},_nsRoutesParents:{},_routes:{},win:b.win,middleware:[],currentNS:null,mainNS:[],_navCount:0,_pathToRegexp:function(a,b,c,d){return a instanceof RegExp?a:(a instanceof Array&&(a="("+a.join("|")+")"),a=a.concat(d?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,c,d,e,f,g){return b.push({name:e,optional:!!g}),c=c||"",[g?"":c,"(?:",g?c:"",(d||"")+(f||d&&"([^/.]+?)"||"([^/]+?)")+")",g||""].join("")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$",c?"":"i"))},_extractRouteParameters:function(a,b,c){var d,e,f,g,h=b.exec(a),i=[];if(!h)return i;for(d=1,e=h.length;e>d;++d)f=c[d-1],g="string"==typeof h[d]?decodeURIComponent(h[d]):h[d],f?i[f.name]=void 0!==i[f.name]?i[f.name]:g:i.push(g);return i},getHistory:function(){return c.history||(c.history=new c.History,c.history.handlers.push({route:/.*/,callback:function(){}})),c.history},hasHistory:function(){return this._navCount>0},getFragment:function(a){return this.getHistory().getFragment(a)},navigate:function(b,c){c=c||{},b=this.getFragment(b);var d,e,f,g=this.getHistory(),h=c.trigger,i=g.fragment===b,j=a.has(c,"navigated")?c.navigated:!0;for(c.replace||this._navCount++,g.navigate(b,{replace:c.replace}),f=0,e=g.handlers.length;e>f;f++)if(d=g.handlers[f],d.route.test(b)){!i&&h?d.callback(b,c.meta,j):(this.currentNS=d.ns,this._nsRoutes[this.currentNS]=b);break}return this},navigateToMainNS:function(b,c){b=-1!==a.indexOf(d.mainNS,b)?b:"main",d.navigate(this.getNSFragment(b)||"",c)},loadUrl:function(a){return this.getHistory().history.loadUrl(a),this},back:function(){return this.hasHistory()?(this._navCount--,this.win.history.back()):this.navigate("",{trigger:!0}),this},forward:function(){return this.win.history.forward(),this},getNSFragment:function(a){return this._nsRoutes[a]},getNSParents:function(a){return this._nsRoutesParents[a]||[]},getNS:function(a){return-1!==a.indexOf(":")&&a.split(":").shift()||""},_route:function(c,d,e,f,g,h){e=e.toLowerCase();var i=this,j=[],k=-1!==e.indexOf(":")&&e.split(":").shift()||"",l=this.getHistory().handlers,m={name:e,ns:k,route:this._pathToRegexp(d,j,!1,!1),callback:function(b,c,d){var f={_id:a.uniqueId("route"),route:e,routeNS:k,prevRouteNS:i.currentNS,url:b,fragment:b,params:i._extractRouteParameters(b,m.route,j),meta:c||{}},g=a.clone(h)||{};i.currentNS=k,g.back=!d,g.route=e,i._currentRoute=[e,f,g],i._routes[e](f,g)}};if("string"!=typeof d)throw new Error("Only string routes are allowed");if(0===j.length?l.unshift(m):l.splice(l.length-1,0,m),"function"==typeof this._routes[e]){if(g)throw new Error('Route "'+e+'" is already registered')}else f=this.middleware.concat(f),this._routes[e]=function(d,h){var j=0,l=!1,m=function(c){var n=f[j++];if(c)m.stop(),i.error(c,d,h);else if(n)n(d,m,h);else if(!l){b.log("ROUTE",e,d,h),k&&a.has(d,"fragment")&&(i._nsRoutes[h.ns]=d.fragment),i.trigger("beforeroute:"+e,i,d,h),i.trigger("beforeroute",i,e,d,h);try{g(d,h)}catch(o){i.error(o,d,h)}i.trigger("route:"+e,i,d,h),i.trigger("route",i,e,d,h)}};m._cid=a.uniqueId("route-next"),m.stop=function(){j=f.length,l=!0,m()
},m.navigate=function(a,b){m.stop(),i.navigate(a,b)},h=a.defaults(h||{},{ns:k,parent:h.back||-1!==a.indexOf(i._nsRoutesParents[k]||[],e)}),i._nsRoutesParents[h.ns]=c||[],i._currentRouteChain&&(i._currentRouteChain.stop(),j=0),i._currentRouteChain=m,m()}},getCurrentRoute:function(){return this._currentRoute&&this._currentRoute[0]},error:function(a,b,c){return this.trigger("error",this,a,b,c),this},route:function(b,c){var d=a.rest(arguments,2),e=d.pop(),f=1===d.length&&a.isArray(d[0])?d[0]:d;if("function"!=typeof e)throw new Error("Route needs a callback to function");return this._route([],b,c,f,e),this},alias:function(){var b=a.toArray(arguments),c=b.pop(),d=b.pop(),e=b.shift()||[];return this._route(e||[],d,c),this},childRoute:function(b,c,d){var e=a.rest(arguments,3),f=e.pop(),g=1===e.length&&a.isArray(e[0])?e[0]:e;if("function"!=typeof f)throw new Error("Route needs a callback to function");return this._route(b||[],c,d,g,f,{child:!0}),this},triggerRoute:function(a,b,c){return this._routes[a](b||{},c||{},!0),this},refresh:function(){return this.getCurrentRoute()&&this.triggerRoute.apply(this,this._currentRoute),this}});return d.route("*","not-found",function(){}),b.navigate=a.bind(d.navigate,d),d})}(this),function(a){"use strict";var b=a.APP;b.register("rum",["router"],function(c){var d,e=b.win,f=(b.$win,b._),g=b.get("name"),h=(b.get("lang"),[]),i=0,j=function(b,c,d,i,j,k){e.setTimeout(function(){a.NREUM?a.NREUM.inlineHit(encodeURIComponent(g.toUpperCase()+":"+b),c||0,d||0,i||0,j||0,k||0):h.push(f.toArray(arguments))},0)},k=function(){i+=1,a.NREUM?f.forEach(h,function(a){j.apply(e,a)}):10>i&&a.setTimeout(k,5e3)};return a.NREUM||a.setTimeout(k,5e3),c.middleware.unshift(function(a,b){d={id:a._id,start:(new Date).getTime()},b()}),c.on("beforeroute",function(a,b,c){d&&d.id===c._id&&(d.middleware=(new Date).getTime()-d.start)}),c.on("route",function(a,b,c){var e,f=c&&"/"+(c.url||"");f&&d&&d.id===c._id&&(e=(new Date).getTime()-(d.start+d.middleware),j("/"+b.toUpperCase()+"/"+f,0,0,d.middleware,e))}),j})}(this),function(a){"use strict";var b=a.APP;b.register("storage",function(){var a=function(a){var b={},c=function(){var a=this;this.setItem=function(b,c){a[b]=c},this.getItem=function(b){return a[b]},this.removeItem=function(b){a[b]=null,delete a[b]}};try{b={local:a.localStorage,session:a.sessionStorage}}catch(d){b={local:new c,session:new c}}return b}(b.win),c=b._,d="leo:",e=function(a){return 0!==a.indexOf(d)&&(a=d+a),a},f=function(a){return 0===a.indexOf(d)?a.substring(d.length):a},g=function(a){this._engine=a};return g.prototype={set:function(a,b){try{this._engine.setItem(e(a),JSON.stringify(b))}catch(c){}return this},get:function(a){var b;try{if(b=this._engine.getItem(e(a)))try{b=JSON.parse(b)}catch(c){this.set(e(a),b)}}catch(c){}return b},remove:function(a){try{this._engine.removeItem(e(a))}catch(b){}return this},has:function(a){return c.has(this._engine,e(a))},keys:function(){return c.keys(this._engine)},mapKeys:function(a){return a?c.map(this.keys(),function(b){return a(f(b))}):c.map(this.keys(),function(a){return f(a)})}},{buildKey:e,retrieveKey:f,local:new g(a.local),session:new g(a.session)}})}(this),function(a){"use strict";var b=a.APP;b.register("string-helpers",function(){var a=(b.doc,b._),c=a.str,d={SEK:{decimals:2,thousandSeparator:" ",centSeparator:","}},e={SE:{dateFormat:"B"},PT:{endianSeperator:"/"},FR:{endianSeperator:"/"},IT:{endianSeperator:"/"},GB:{endianSeperator:"/"}},f=new RegExp("\\{\\{[^\\}]{2,}\\}\\}","g"),g=new RegExp("[\\.\\[\\]\\s]"),h=a.extend({qsParse:function(a){var b,c,d,e=a.split("&"),f=e.length,g={};for(b=0;f>b;b++)c=e[b].split("="),d=decodeURIComponent(c.shift()),d&&(g[d]=decodeURIComponent(c.join("=")));return g},qsFormat:function(b){return a.map(b,function(a,b){return b+"="+encodeURIComponent(a)}).join("&")},interpolate:function(a,b,c){c=c||"";var d,e,h,i,j,k,l,m,n=a.match(f)||[];for(h=0,d=n.length;d>h;h++){for(e=n[h],i=e.substr(0,e.length-2).substr(2).split(g),m=b,l=0,j=i.length;j>l;l++)if(k=i[l]){if(!m||!m.hasOwnProperty(k)){m=c;break}m=m[k]}a=a.replace(e,m)}return a},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isString:function(a){return"string"==typeof a},removeWhitespaces:function(a){return a.replace(/\s+/g,"")},dateFromIsoString:function(a){var b=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})\.(\d{3})Z$/,c=h.isString(a)&&a.match(b);return c?new Date(Date.UTC(+c[1],+c[2]-1,+c[3],+c[4],+c[5],+c[6],+c[7])):null},formatDate:function(b,c){var d=a.defaults(e[c]||{},{dateFormat:"L",endianSeperator:"."});return b?this._formatDateByFormat(b,d.dateFormat,d.endianSeperator):""},formatTime:function(a){return c.pad(a.getHours(),2,"0")+":"+c.pad(a.getMinutes(),2,"0")+":"+c.pad(a.getSeconds(),2,"0")},getCountryDateFormat:function(b){var c=a.defaults(e[b]||{},{dateFormat:"L"});return c.dateFormat},capitaliseFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},_formatDateByFormat:function(a,b,d){return"B"===b?a.getFullYear()+"-"+c.pad(a.getMonth()+1,2,"0")+"-"+c.pad(a.getDate(),2,"0"):"M"===b?c.pad(a.getMonth()+1,2,"0")+"/"+c.pad(a.getDate(),2,"0")+"/"+a.getFullYear().toString().substr(2,2):c.pad(a.getDate(),2,"0")+d+c.pad(a.getMonth()+1,2,"0")+d+a.getFullYear().toString().substr(2,2)},formatCreditCardNumber:function(a){return a=a.replace(/\-/g,""),a=a.replace(/ /g,""),a=a.replace(/(\d{4})/g,"$1 "),a=a.replace(/\s+$/,""),a=a.substring(0,19)},formatMoney:function(b,e,f){e&&(e=e.toUpperCase()),this.isNumber(b)?this.isString(b)&&(b=parseFloat(b)):b=c.toNumber(b);var g=a.defaults(d[e]||{},{decimals:2,thousandSeparator:".",centSeparator:","}),h=b%1!==0?c.numberFormat(b,g.decimals,g.centSeparator,g.thousandSeparator):c.numberFormat(b,0,g.centSeparator,g.thousandSeparator);return f?"<currency>"+h+" "+e+"</currency>":h+" "+e},formatPhone:function(b,c){var d,e=c.replace(/[^0-9\+]+/g,"").replace(/^[0]{2}/,"+");return b=b&&"+"===b[0]?b.substr(1,3):b||"",b&&(e=e.replace("+"+b,"")),"46"===b?(e=e.replace(/^0/,""),d="0"===e.substr(1,1)?e.match(/^(..)?(...)?(..)?(..)?(.+)?$/).slice(1):e.match(/^(...)?(..)?(..)?(.+)?$/).slice(1)):"44"===b?(e=e.replace(/^0/,""),d="0"===e.substr(1,1)?e.match(/^(..)?(....)?(....)?(.+)?$/).slice(1):e.match(/^(...)?(...)?(.+)$/).slice(1)):d=e.match(/..?/g),(b&&"+"+b+" ")+a.compact(d).join(" ")}},c);return h})}(this),function(a){"use strict";var b=a.APP;b.register("template",["string-helpers","templates","i18n","user"],function(a,c,d,e){var f=b._,g=b.get("staticUrl"),h=function(a){var b=c[a]||function(){return'Unable to find template "'+a+'"!'};return function(a,c){return a=f.reduce(h.helpers,function(a,b,d){if(!c&&f.has(a,d))throw new Error('"'+d+'" is already by used a template helper!');return a[d]=b,a},a||{}),a.ctx=a,b(a)}};return h.helpers={cdnUrl:function(a){return g+"/"+a},i18n:d,isLoggedIn:function(){return e.isLoggedIn()},partial:function(a,b){return h("_partial."+a)(b,!0)},str:a,url:function(a){return a}},h})}(this),function(a){"use strict";var b=a.APP;b.register("tracker",["affiliate","string-helpers","api"],function(c,d,e){a._gaq||(a._gaq=[]);var f=b.win,g=(b.doc,b._),h=f.Image,i=(b.get("env"),b.get("affiliates")||{}),j=function(){var a=function(){var a,b,d;return c.id&&g.has(i,c.id)&&(a=i[c.id],b=c.get("pid"),b&&a.groups&&(d=(g.find(a.groups,function(a){return-1!==a[0].indexOf(b)})||[])[1]),!d&&a&&a.events&&(d=a.events)),d};return c.on("change",function(){j=a()}),a()}(),k="c3ea13a2-bed0-4afc-a79b-a231d7cca48d",l="https://tracking.netrefer.com/Tracking.svc/Track?to=notify&clientId={{ clientId }}&ActionName={{ actionName }}&TrackingTag={{ btag }}&customerID={{ accountId }}",m={landing:"ActionTracking-Landing",signup:"ActionTracking-Signup",firstdeposit:"ActionTracking-FirstDeposit",deposit:"ActionTracking-Deposit"},n=function(){var a=1,b=["654955","655029","654800","654785","654660","654689","654824"];return c.id&&-1!==g.indexOf(b,c.id)&&(a=2),a},o=g.after(n(),function(){c.id&&(c.save(),o=function(){})}),p=function(){a._gaq.push(g.toArray(arguments))},q=function(a){return""+(a&&a.id||"anonymous")},r=function(a,b){return g.has(r.EVENT,a.toUpperCase())&&r[a.toLowerCase()](b),r};return r.EVENT={LANDING:"landing",SIGNUP:"signup",DEPOSIT:"deposit",FIRST_DEPOSIT:"firstdeposit"},r.affiliatePixel=function(a,b){if(j){var e,f=j[a],g={ts:(new Date).getTime(),btag:c.get("btag"),pid:c.get("pid"),bid:c.get("bid"),affiliateId:c.id,accountId:b&&b.id};f||a!==r.EVENT.FIRST_DEPOSIT||(f=j[r.EVENT.DEPOSIT]),"NETREFER"===f&&(f=l,g.clientId=k,g.actionName=m[a]),f&&(e=new h,e.src=d.interpolate(f,g))}},r.event=function(){var a=g.toArray(arguments);a.unshift("_trackEvent"),p.apply(null,a)},r.timing=function(){},r.pageView=function(){o();var a=g.toArray(arguments);a.unshift("_trackPageview"),p.apply(null,a)},r.landing=function(a){r.affiliatePixel("landing",a),r.event("landing",q(a),c.id,null,!0)},r.signup=function(a){r.affiliatePixel("signup",a),r.event("signup",q(a),c.id)},r.deposit=function(a){var b=a&&a.get("firstDeposit")===a.get("latestDeposit"),d=b?"firstdeposit":"deposit";r.affiliatePixel(d,a),r.event(d,q(a),c.id)},r.tag=function(a){e.tag(a)},b.on("track",function(){r.event.apply(r,g.toArray(arguments).slice(1))}),b.on("timing",function(){r.timing.apply(r,g.toArray(arguments).slice(1))}),b.on("ready",function(){b.use("user",function(a){var b=function(){a.isLoggedIn()&&f.device&&f.device.uuid&&r.tag({deviceId:f.device&&f.device.uuid})};a.isLoggedIn()&&b(),a.on("login logout",b)})}),r})}(this),function(a){"use strict";var b=a.APP;b.register("user",["model.user","bootstrap","api"],function(a,c,d){var e=new a(c.data("user"));return b.on("bootstrap",function(){var a=c.data("user");a?e.set(a):e.isLoggedIn()&&e.logout()}),d.on("death-by-server",function(){e.isLoggedIn()&&e.logout()}),e.on("logout",d.clearCacheUser),e.isLoggedIn()||d.clearCacheUser(),e})}(this),function(a){"use strict";var b=a.APP;b.register("validate",["string-helpers"],function(a){var c=b._,d=function(a){return a.trim?a.trim():a.replace(/^[\s]+/,"").replace(/[\s]+$/,"")},e={};return e.password=function(a){return!!(a&&a.toString().match(/^[0-9a-zA-Z*!@?#|()\/_,.;:'\-]{6,}$/)&&a.length<=30)},e.mobile=function(b){var c=a.formatPhone("",b&&b.toString()||"");return!!c.match(/^[0-9\s]{10,20}$/)},e.number=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},e.name=function(a){return c.isString(a)&&d(a).length>=2},e.nickName=function(a){return c.isString(a)&&e.nickName.regex.test(d(a))},e.nickName.regex=/^[a-zA-Z0-9]{3,}$/,e.email=function(a){return a=d(a||""),e.email.regex.test(a)},e.email.regex=/^[a-z0-9._-]+@[a-z0-9.-]+\.[a-z]{2,4}$/i,e.accountName=function(a){return!!a&&e.accountName.reqex.test(a)},e.accountName.reqex=/^[a-z0-9._\-@]+$/i,e.personalIdNumber=function(a,b){return"SE"===b?e.personalIdNumberSE(a):"NO"===b?e.personalIdNumberNO(a):!1},e.personalIdNumberSE=function(a){return a=d((a||"").toString()),e.personalIdNumberSE.regex.test(a)},e.personalIdNumberSE.regex=new RegExp("^(19[0-9]{6}|20[0-9]{6}|[1-9][0-9]{5})[\\-]?[0-9]{4}$"),e.personalIdNumberNO=function(a){return a=d((a||"").toString()),e.personalIdNumberNO.regex.test(a)},e.personalIdNumberNO.regex=new RegExp("^(0[1-9]|1[0-9]|2[0-9]|3[0-1])(0[1-9]|1[0-2])([0-9]{2})([0-9]{3})([0-9]{2})$"),e.birthDate=function(b){var d,e,f,g,h=b;return c.isString(b)&&24===b.length&&(e=parseInt(b.substr(0,4),10),f=parseInt(b.substr(5,2),10)-1,g=parseInt(b.substr(8,2),10),h=a.dateFromIsoString(b),!h||e!==h.getUTCFullYear()||f!==h.getUTCMonth()||g!==h.getUTCDate())?!1:c.isDate(h)?(d=new Date,d.setFullYear(d.getFullYear()-18),d>h):!1},e.validThru=function(a){var b,d=a;if(c.isString(a)&&24===a.length)d=new Date(a);else if(!c.isDate(a)&&c.isObject(a)&&(d=new Date(a.year||1900,a.month&&a.month-1),a.month<1||a.month>12))return!1;return c.isDate(d)?(b=new Date,b.setDate(1),b.setHours(0,0,0,0),d>=b):!1},e.creditCardValidationNumber=function(a){return e.creditCardValidationNumber.regex.test(a)},e.creditCardValidationNumber.regex=/^\d{3,4}$/,e.creditCardVisa=function(a){return null!==a&&a&&0!==a.length?(a=a.replace(/\s|-/g,""),e.creditCardVisa.regex.test(a)&&e.luhnCheckSum(RegExp.$1)?!0:!1):!1},e.creditCardVisa.regex=/^(4\d{12}(?:\d{3})?)$/,e.creditCardMasterCard=function(a){if(null===a||!a||0===a.length)return!1;if(a=a.replace(/\s|-/g,""),e.creditCardMasterCard.regex.test(a)){var b=RegExp.$1+RegExp.$2+RegExp.$3+RegExp.$4;if(e.luhnCheckSum(b))return!0}return!1},e.creditCardMasterCard.regex=/^(5[1-5]\d{2})[\s\-]?(\d{4})[\s\-]?(\d{4})[\s\-]?(\d{4})$/,e.luhnCheckSum=function(a){var b,c,d=[0,2,4,6,8,1,3,5,7,9],e=0,f=!1,g=a.replace(/[^\d]/g,"");if(0===g.length)return!1;for(c=g.length-1;c>=0;--c)b=parseInt(g.charAt(c),10),e+=(f=!f)?b:d[b];return e%10===0},e.notEmpty=function(a){var b=c.isEmpty(a);return c.isString(a)?!!a.replace(/^[\s]+/,"").replace(/[\s]+$/,"").length:c.isBoolean(a)?!0:c.isNumber(a)?e.number(a):!b},e.postcode=function(a,b){return"GB"===b?e.postcodeGB(a):!1},e.postcodeGB=function(a){a=d(a||"").toUpperCase();var b=e.postcodeGB.regex.test(a);return b},e.postcodeGB.regex=new RegExp("^([A-PR-UWYZ0-9][A-HK-Y0-9][AEHMNPRTVXY0-9]?[ABEHMNPRVWXY0-9]?[\\s\\-]?[0-9][ABD-HJLN-UW-Z]{2}|GIR 0AA)$"),e})}(this),function(a){"use strict";var b=a.APP;b.register("view.form",["view","template"],function(a){var c=b._,d=b.Backbone.View.prototype,e=a.extend({constructor:function(){this._state=this.state||{},this.resetState(),this.model&&(this.listenTo(this.model,"error",c.bind(this._onModelError,this)),this.listenTo(this.model,"invalid",c.bind(this._onModelError,this))),this.on("error",this._onError,this),this.on("validate",this._onValidate,this),a.apply(this,arguments)},events:{"click div.btn-group-radio button":function(a){var b=this.$(a.currentTarget),c=b.closest("div.btn-group"),d=c.find("input"),e=(d.attr("name"),b.data("radio-value"));c.find("button").removeClass("active"),b.addClass("active"),d.val(e).trigger("change")},submit:function(a){if(a.preventDefault(),this.loading(),this.state.posted=this.state.isSubmitted=!0,!this._submitted){this._submitted=!0;var b=this.$(a.target),d=this.serialize(b),e=c.reduce(c.keys(d),function(a,b){var d=this.validators[b];return c.isFunction(d&&d.value)&&(a[b]=d.value.call(this,a[b])),a},d,this);this.validate(e,c.bind(function(b,d){this.trigger("validate",this,b,d),c.compact(c.values(b)).length||(b=null),this.trigger("submit",this,b,d,a),c.defer(c.bind(function(){this._submitted=!1},this))},this))}}},_configure:function(){d._configure.apply(this,arguments),this.validators=this.validators||{},this._setupValidators()},_setupValidators:function(a){!a&&this.validators&&(a=c.isFunction(this.validators)?this.validators():this.validators),this._validatorEvents={},this._hasHadValue={},c.forEach(a||[],function(a,b){a.validators||(a={validators:a},this.validators[b]=a);var d=!c.isFunction(a.validators)&&c.keys(a.validators),e=function(c){var d,e,f=this.$(c.target),g=f.attr("type");"radio"===g||"checkbox"===g?(d=f.closest("fieldset").find("input[name="+b+"][type="+g+"]"),e=(d.serializeArray().pop()||{}).value):e=f.val(),a.validate(e,{event:c})};a._validate||(a._validate=function(e,f){c.isFunction(f)&&(f={callback:f}),e=a.value?a.value.call(this,e):e;var g,h={};h[b]=e,f=f||{},c.isFunction(a.validators)?g=a.validators.call(this,e):c.some(d,function(c){var d=a.validators[c],f=d.call(this,e);return f?void 0:(g={},g[b]=new Error(c),!0)},this),g||(g={},g[b]=null),f.callback?f.callback(g,h,f):f.silent||(this.trigger("validate",this,g,h,f),this.trigger("validate:"+b,this,g[b],h[b],f))}),a.validate=c.bind(a._validate,this),a.events&&(c.isArray(a.events)||(a.events=[a.events]),c.forEach(a.events,function(a){this._validatorEvents[a]=e},this))},this)},_onValidate:function(a,b,c){this.updateValidation(b),this.updateModel(b,c)},_onModelError:function(a,b){this.updateValidation(b)},_onError:function(a,b){this.updateValidation(b)},resetState:function(){return this.state=c.defaults({posted:!1,isSubmitted:!1,error:{},data:{}},this._state),this},validate:function(a,b,d){var e,f={};return c.isObject(a)||null===a||void 0===a?(e=a,d=b):(e={},e[a]=b),c.isFunction(d)&&(d={callback:d}),d=d||{},c.forEach(e,function(a,b){return this.validators[b]?void this.validators[b].validate(a,{callback:function(a){f[b]=a&&a[b]},silent:!0}):void(f[b]=null)},this),d.callback?d.callback(f,e):d.silent||this.trigger("validate",this,f,e,d),this},delegateEvents:function(a){return!a&&this.events&&(a=c.isFunction(this.events)?this.events():this.events),a=c.extend(a||{},this._validatorEvents||{}),d.delegateEvents.call(this,a)},serialize:function(a){var b=c.reduce(a.serializeArray(),function(a,b){return a[b.name]=b.value,a},{});return a.find("input[type=checkbox]:not(:checked)").each(function(){this.name&&(b[this.name]=!1)}),b},updateValidation:function(a,b){return b=b||{},c.forEach(a||[],function(a,c){this.state.error[c]=a,b.silent||this._validationMessage(c,!!a,a&&a.message)},this),this},updateModel:function(a,b){if(this.model&&!this.options.lazyUpdate){var d=c.reduce(a,function(a,c,d){return c||(a[d]=b[d]),a},{});this.model.set(d)}return this},_validationMessage:function(a,b,c){var d=this.$("fieldset."+a),e=this.$(".validation-message.for-field-"+a);return d.addClass(b?"error":"success"),d.removeClass(b?"success":"error"),c?(0===e.length&&(e=this.$('<div class="validation-message for-field-'+a+'"></div>'),d.append(e)),void e.text(this.i18n.error(c))):void e.remove()},_resetForm:function(){this.state.data={},this.model&&this.model.clear(),this.render()}});return e})}(this),function(a){"use strict";var b=a.APP;b.register("view",["template","i18n","user"],function(a,c,d){var e=b._,f=b.$,g=b.doc,h=b.Backbone,i=function(a,b){var c=a.dataset?a.dataset[b]:a.getAttribute("data-"+b);c&&(a.innerHTML=c)},j=h.View.extend({constructor:function(){if(!this.cid){if(this.state=this.state||{},!this.name)throw new Error('All views must have a "name" property!');var a=this.render,b=this.destroy;this._views=[],this.listenTo(d,"change:language",e.bind(this._updateCurrencyContent,this)),this.on("dom-change",this._updateCurrencyContent,this),this.render=function(b){var c=["view",this.name+"-view"];return this.destroyViews(),this.$el.empty(),this.className&&c.push(this.className),this.el.className=c.join(" "),a?a.apply(this,arguments):this.template&&(this.el.innerHTML=this.template()),this.trigger("dom-change",this),b&&b.silent||this.trigger("render",this),this},this.destroy=function(a){return b&&b.apply(this,arguments),this.destroyViews(),this.detach(),this.$el.empty(),this.undelegateEvents(),this.$el.off(),a&&a.silent||this.trigger("destroy",this),this.off(),this.stopListening(),this},h.View.apply(this,arguments)}},_updateCurrencyContent:function(){var a,c,e,f=(d.get("currency")||b.get("currency")||"").toLowerCase();if(f)for(a=this.el.getElementsByTagName("currency"),e=0,c=a.length;c>e;e++)i(a[e],f)},$:function(a,b){return f(a,b||this&&this.el)},make:function(a,b,c){var d=g.createElement(a);return b&&this.$(d).attr(b),c&&(d.innerHTML=c),d},i18n:c,transition:function(a,c,d){return b.transition(a,c,d),this},translate3d:function(a,c,d){return b.transition.translate3d(a,c,d),this},translate:function(a,c,d,e){return b.transition.translate(a,c,d,e),this},createView:function(a,b,c){b=e.defaults(b||{},{container:this.el});var d=new a(b);return this._views.push(d),c&&this.listenTo(d,"all",e.bind(function(){var a=e.toArray(arguments);a[0]=c+":"+a[0],this.trigger.apply(this,a)},this)),d.bind("destroy",function(){var a=e.indexOf(this._views,d);-1!==a&&this._views.splice(a,1)},this),d},destroyViews:function(){return e.forEach(this._views,function(a){a.destroy()}),this},reportError:function(a){return b.error(a,"view."+this.name+".js"),this},isAttached:function(){var a=this.el.parentNode&&this.el.parentNode.nodeType;return 1===a||9===a},attach:function(a){var b=this.options.container;return this.el.parentNode!==b&&(this.el.parentNode&&this.detach({silent:!0}),e.has(b,"length")&&(b=this.options.container[0]),a&&a.prepend?b.insertBefore(this.el,b.firstChild):b.appendChild(this.el)),a&&a.silent||this.trigger("attach",this),this},detach:function(a){return this.isAttached()&&this.el.parentNode.removeChild(this.el),a&&a.silent||this.trigger("detach",this),this},unfocus:function(){return this.$(":focus").blur(),this},getContainerSize:function(){var a,b={width:0,height:0};return this.isAttached()&&(a=this.el.parentNode,b.width=a.offsetWidth,b.height=a.offsetHeight),b},loading:function(){return this._$loader||(this._$loader=this.$("div.loader")),this._$loader.length||(this._$loader=this.$('<div class="loader"></div>')),this._$loader.get(0).parentNode!==this.el&&this._$loader.appendTo(this.el),this.$el.addClass("show-loading"),this.unfocus(),this},hideLoading:function(){return this.$el.removeClass("show-loading"),this.unfocus(),this},overlayMessage:function(a,b,d){this._$overlayMessage||(this._$overlayMessage=this.$("div.overlay-message")),this._$overlayMessage.length||(this._$overlayMessage=this.$('<div class="overlay-message"></div>').appendTo(this.el)),d&&d.silent||this.trigger("show:overlay-message",this,a,b,d),d=d||{},e.isFunction(d)&&(d={callback:d});var f;return"function"==typeof a?(this._overlayView&&this._overlayView.destroy({silent:!0}),b=e.extend(b||{},{container:this._$overlayMessage}),this._overlayView=this.createView(a,b,"modal"),this._overlayView.render(),this._overlayView.attach(),f=this._overlayView.$el):(this._overlayView=null,"string"==typeof a&&(a={message:a}),f=this.$("<div></div>"),a.icon&&f.append(this.make("i",{"class":a.icon})),a.title&&f.append(this.make("h4",null,a.title)),a.message&&f.append(this.make("p",null,a.message)),d.hideButton||(this._$overlayMessage.delegate("button","click",e.bind(function(a){a.preventDefault(),d.callback&&d.callback(a,d),this.hideOverlayMessage()},this)),f.append(this.make("Button",{"class":"btn btn-block btn-primary"},c("LABEL_OK")))),this._$overlayMessage.empty(),this._$overlayMessage.append(f)),this.$el.addClass("show-overlay-message"),f.css({top:Math.max(0,Math.round((this._$overlayMessage.height()-(f.outerHeight()+80))/2))}),this.transition(this._$overlayMessage.get(0),{opacity:1},{duration:this.duration||300,delay:this.delay||0,easing:this.easing||"ease-out",callback:j.modifiesDOM(function(){d.silent||(this._overlayView&&this._overlayView.trigger("shown",this._overlayView,this),this.trigger("shown:overlay-message",this,a,b,d))},this)}),this._overlayView?this._overlayView:this},errorOverlayMessage:function(a,b){return this.overlayMessage({icon:"icon-exclamation-sign",message:a},null,b)},successOverlayMessage:function(a,b){return this.overlayMessage({icon:"icon-ok-sign",message:a},null,b)},hideOverlayMessage:function(a){return a&&a.silent||this.trigger("hide:overlay-message",this,a),this._$overlayMessage.undelegate(),this.transition(this._$overlayMessage.get(0),{opacity:0},{duration:this.duration||300,delay:this.delay||0,easing:this.easing||"ease-out",callback:e.bind(function(){this.$el.removeClass("show-overlay-message"),this._overlayView&&(this._overlayView.destroy(),this._overlayView=null),this._$overlayMessage&&(this._$overlayMessage.attr("tabindex",""),this._$overlayMessage.remove(),this._$overlayMessage=null),a&&a.silent||this.trigger("hidden:overlay-message",this,a)},this)}),this},render:function(){var a={};this.model&&(a.model=this.model.toJSON()),this.collection&&(a.collection=this.collection.toJSON()),this.template&&(this.el.innerHTML=this.template(a))},toHTML:function(){return this.el.outerHTML}},{transition:b.transition,modifiesDOM:function(a,b){return function(){var c=b||this,d=a.apply(c,arguments);return c.trigger("dom-change",this),d}}});return g.createElement("currency"),g.createElement("payment-contract"),j})}(this),function(a){"use strict";var b=a.APP;b.register("view.layout",["view"],function(a){var c=b._,d=["beforeShow","beforeHide","afterShow","afterHide"],e=function(a,b){return b&&!c.isArray(b)&&(b=[b]),function(c){for(var d=0,e=b&&b.length||0;e>d;d++)b[d].call(a,c)}},f=a.extend({initialize:function(){this._initRegions(),this.on("render",this._resetRegions,this)},_initRegions:function(){this.regions=this.regions||{};var a=this,b=function(){a.$(":focus").blur()};c.forEach(this.regions,function(f,g){var h=f.show&&c.bind(f.show,a),i=f.hide&&c.bind(f.hide,a);f.name=g,f.options=f.options||{},f.ready=!0,f.visible=!1,c.forEach(d,function(b){f[b]=e(a,f[b])}),f.show=function(d,e,i,j){return i=c.defaults(i||{},f.options),b(),a._showRegion(g,f.el,d,e,i,h,j)},f.hide=function(d,e){return d=c.defaults(d||{},f.options),b(),a._hideRegion(g,d,i,e)}}),this._updateRegions(),this.on("render",this._updateRegions,this)},_resetRegions:function(){c.forEach(this.getAllRegions(),function(a){a.ready=!0,a.visible=!1,a.prevView&&(a.prevView.destroy(),a.prevView=null),a.view&&(a.view.destroy(),a.view=null)})},_updateRegions:function(){var a=this;c.forEach(this.regions,function(b){b.selector&&(b.$el=a.$(b.selector),b.el=b.$el.get(0)),b.selectors&&c.forEach(b.selectors,function(c,d){var e=a.$(c);b["$"+d]=e,b[d]=e.get(0)})})},getRegion:function(a){return this.regions[a]},getAllRegions:function(){return c.values(this.regions)},getVisibleRegion:function(){var a,b,c,d=this.getAllRegions();for(c=0,b=d.length;b>c;c++)if(a=d[c],a.visible)return a},_showRegion:function(b,d,e,f,g,h,i){g=g||{};var j,k=this,l=this.getRegion(b),m=function(){l.view&&!l.view.isAttached()&&l.view.attach({prepend:!!g.prepend})},n=function(){l.prevView&&l.prevView!==l.view&&l.prevView.el&&l.prevView.destroy(),l.prevView=l.view,l.ready=!0,l.visible=!0,i&&i(l),l.afterShow(g),g.silent||(l.view&&l.view.trigger("shown",l.view,k),k.trigger("shown:"+b,k,g))},o=function(){l.beforeShow(g),g.silent||(l.view&&l.view.trigger("show",l.view,k),k.trigger("show:"+b,k,g)),h?(h(l,g,n),m()):(m(),n())};return l.el=d,e?(e instanceof a?j=e:(f=c.extend(f||{},{container:d,viewport:this.viewport}),j=this.createView(e,f,b+":"+e.prototype.name)),l.ready?(l.view=j,l.ready=!1,l.view.render(),o()):this.once("shown:"+b,function(){this._showRegion(b,d,j,null,g,h)},this)):(j=l.view,o()),j},_hideRegion:function(a,b,d,e){b=c.defaults(b||{},{destroyView:!0});var f=this,g=this.getRegion(a),h=function(){g.visible=!1,b.destroyView&&g.view&&g.view.el&&(g.view.destroy(),g.view=null,g.prevView=null),e&&e(g),g.afterHide(b),b.silent||(g.view&&g.view.trigger("hidden",g.view,f),f.trigger("hidden:"+a,f,b))},i=function(){g.beforeHide(b),b.silent||f.trigger("hide:"+a,f),d?d(g,b,h):h()};return g.visible?g.ready?(i(),this):(this.once("shown:"+a,function(){this._hideRegion(a,b,d)},this),this):(e&&e(g),this)}});return f})}(this),function(a){"use strict";var b=a.APP;b.register("view.signup",["view.form","template","validate","api","string-helpers"],function(a,c,d,e,f){var g=b._,h=a.extend({name:"signup",step:1,fields:{},template:g.template("JSON.stringify(ctx, null, '	')"),templateAddressResult:g.template("JSON.stringify(ctx, null, '	')"),events:g.defaults({"click p.terms a":function(a){a.stopImmediatePropagation(),this.trigger("terms",this)},"blur input[name=personalIdNumber]":"_onPersonIdNumberChange","keyup input[name=personalIdNumber]":"_onPersonIdNumberChange","click fieldset.personalIdNumber button:not(.disabled)":function(a){a.preventDefault();var b=this.$("input[name=personalIdNumber]"),c=b.val(),d=this._validatePersonalIdNumber(c);d||this._fetchInfoByIdNumber(c)},"change fieldset.birthDate select:not(.has-changed)":function(a){var b=this.$(a.currentTarget),c=b.closest("fieldset"),d=c.find("select[name=birthDay]"),e=c.find("select[name=birthMonth]");"-"!==d.val()&&"-"!==e.val()&&(d.addClass("has-changed"),e.addClass("has-changed"),this.validate("birthDate",this.validators.birthDate.value.call(this)))},"change fieldset.country select":function(a){var b,c=this.$(a.currentTarget),d=this._$mobileNumberPrefix;this.options&&this.options.phonePrefixes&&(b=this.options.phonePrefixes[c.val()],b&&d.val(b))},"blur input[name=postcode]":"_onPostcodeChange","keyup input[name=postcode]":"_onPostcodeChange","click fieldset.postcode button:not(.disabled)":function(a){a.preventDefault();var b=this.$("input[name=postcode]"),c=b.val(),d=this._validatePostcode(c);d||this._fetchAddressesByPostcode(c)},"click .addresses li":function(a){a.preventDefault();var b=a.target,c=this.$(b).data("id");c&&this._fetchAddressInfoById(c)}},a.prototype.events),validators:{email:{events:"blur input[name=email]",validators:function(a){return this.model.validate("email",a)}},password:{events:"blur input[name=password]",validators:function(a){return this.model.validate("password",a)}},firstName:{events:"blur input[name=firstName]",validators:function(a){return this.model.validate("firstName",a)}},lastName:{events:"blur input[name=lastName]",validators:function(a){return this.model.validate("lastName",a)}},gender:{events:"change input[name=gender]",validators:function(a){return this.model.validate("gender",a)}},birthDate:{events:"change fieldset.birthDate select.has-changed",value:function(a){if(a&&24===a.length)return a;var b=this.$("select[name=birthDay]").val(),c=this.$("select[name=birthMonth]").val(),d=this.$("select[name=birthYear]").val(),e=d+"-"+c+"-"+b+"T00:00:00.000Z";return e},validators:function(a){return this.model.validate("birthDate",a)}},addressStreet:{events:"blur input[name=addressStreet]",validators:function(a){return this.model.validate("addressStreet",a)}},addressZip:{events:"blur input[name=addressZip]",validators:function(a){return this.model.validate("addressZip",a)}},addressCity:{events:"blur input[name=addressCity]",validators:function(a){return this.model.validate("addressCity",a)}},country:{events:"change select[name=country]",validators:function(a){return this.model.validate("country",a)}},mobileNumberPrefix:{events:"change select[name=mobileNumberPrefix]",validators:function(a){return this.model.validate("mobileNumberPrefix",a)}},mobileNumber:{events:"blur input[name=mobileNumber]",validators:function(a){return this.model.validate("mobileNumber",a)}},verification:{events:"blur input[name=verification]",validators:function(a){return this.model.validate("verification",a)}}},initialize:function(){this.on("submit",this._onSubmit,this),this.on("shown",this._focus,this),this.step=this.options.step,this.fields=this.options.fields||[],this.listenTo(this.model,"change:country",this._onChangeCountry)},destroy:function(){},_onPersonIdNumberChange:function(a){var b=a.currentTarget.value,c=this._validatePersonalIdNumber(b);("blur"===a.type||"focusout"===a.type)&&this.updateValidation({personalIdNumber:c}),c?this._$personalIdNumberButton.addClass("disabled"):this._$personalIdNumberButton.removeClass("disabled")},_onPostcodeChange:function(a){var b=a.currentTarget.value,c=this._validatePostcode(b);("blur"===a.type||"focusout"===a.type)&&this.updateValidation({postcode:c}),c?this._$postcodeButton.addClass("disabled"):this._$postcodeButton.removeClass("disabled")},_onChangeCountry:function(){this._$mobileNumberPrefix.val(this._$mobileNumberPrefix.val())},_onSubmit:function(a,c,d){b.log("SignupView::_onSubmit",a,c,d);var f=this,h=this._getFiends();b.async.series([function(a){a(c)},function(a){-1!==g.indexOf(h,"email")&&f.model.has("email")?e.isEmailAddressAvailable(f.model.get("email"),function(c,d){var e;c||d||(e={email:new Error(b.ERROR.EMAIL_TAKEN)}),a(e)}):a()},function(a){1===f.step?(c=f.model.validateStep(f.step),c?a(c):f.model.save(null,{validate:!1,success:function(){a(!0),f.trigger("next",this)},error:function(b,c){a(c)}})):a()},function(a){var b=f.model.validate();a(b&&b)},function(a){f.model.register({validate:!1,success:function(c,d,e){b.log("SignupStep::model::save::success",arguments),a(),f.trigger("register",this,d,e)},error:function(c,d){b.log("SignupStep::model::save::error",arguments),a(d)}})}],function(a){f.hideLoading(),a instanceof Error?(f.reportError(a),f.errorOverlayMessage(f.i18n.error(a.message))):g.isObject(a)&&f.updateValidation(a)})},_focus:function(){if(1===this.step){var a=this;g.defer(function(){a.$el.find("input").first().focus()})}},_getFiends:function(){return this.fields},_fetchInfoByIdNumber:function(a){this.loading(),e.personalInfo(a,function(a,c){this.hideLoading(),a?a.message===b.ERROR.INVALID_REQUEST_PARAMS?this.trigger("error",this,{personalIdNumber:a}):(this.reportError(a),this.errorOverlayMessage(this.i18n.error(a.message))):(this.state.error.personalIdNumber=null,this.validate(c,{silent:!0,callback:g.bind(function(a){this.updateValidation(a,{silent:!0})
},this)}),this.state.error.birthDate||(this.state.disableBirthDate=!0),this.model.set(c,{validate:!1}),this.trigger("personal",this,c))},this)},_fetchAddressesByPostcode:function(a){this.loading(),e.getAddressesByPostcode(a,function(c,d){this.hideLoading(),c?c.message===b.ERROR.INVALID_REQUEST_PARAMS?this.trigger("error",this,{postcode:c}):(this.reportError(c),this.errorOverlayMessage(this.i18n.error(c.message))):d&&d.length?(this.state.error.postcode=null,this.trigger("addresses",this,d)):this.errorOverlayMessage(this.i18n("ERROR_ADDRESSES_NOT_FOUND",{postcode:a}))},this)},_fetchAddressInfoById:function(a){this.loading(),e.getAddressById(a,function(a,c){this.hideLoading(),a?a.message===b.ERROR.INVALID_REQUEST_PARAMS?this.trigger("error",this,{postcode:a}):(this.reportError(a),this.errorOverlayMessage(this.i18n.error(a.message))):(this.validate(c,{silent:!0,callback:g.bind(function(a){this.updateValidation(a,{silent:!0})},this)}),this.model.set(c,{validate:!1}),this.trigger("address",this,c))},this)},_validatePersonalIdNumber:function(a){return d.personalIdNumber(a,this.options.country)?!1:new Error("ERROR_INVALID_PERSONAL_ID_NUMBER")},_validatePostcode:function(a){return d.postcode(a,this.options.country)?!1:new Error("ERROR_INVALID_POSTCODE")},_renderContext:function(){var a=this,b=this.options.countries.sort(function(b,c){var d=a.i18n("COUNTRY_"+b).toLowerCase(),e=a.i18n("COUNTRY_"+c).toLowerCase();return d>e?1:-1}),c=g.defaults(g.clone(this.state),{today:new Date,disableBirthDate:!1,step:this.step,fields:this._getFiends(),countries:b,mobileNumberPrefixes:g.chain(this.options.phonePrefixes).map(function(a,b){return{prefix:a,code:b}}).sortBy(function(a){return parseInt(a.prefix,10)}).value(),dateFormat:f.getCountryDateFormat(this.model.get("country")||"SE")}),d=this.model.getBirthDate();return c.data=this.model.toJSON(),c.data.birthYear=d&&d.getUTCFullYear()||1980,c.data.birthMonth=d&&d.getUTCMonth(),c.data.birthDay=d&&d.getUTCDate(),c},render:function(){var a=this._renderContext();this.el.innerHTML=this.template(a),this._$personalIdNumberButton=this.$("fieldset.personalIdNumber button"),this._$mobileNumberPrefix=this.$("select[name=mobileNumberPrefix]"),this._$postcodeButton=this.$("fieldset.postcode button"),this.$el.removeClass("step-1 step-2").addClass("step-"+this.step)}});return h})}(this),function(a){"use strict";var b=a.APP,c=b.win,d=(b.$win,b._),e=b.async,f=b.doc,g=f.getElementById("splashScreen"),h=g&&g.getElementsByTagName("div")||[],i=h[0],j=h[1],k=c.applicationCache,l=b.get("time"),m=b.get("name"),n=b.get("version"),o=b.get("debug"),p=b.get("env"),q=function(){var a,b=[],c=function(a,c){var d=(new Date).getTime()-l,e={time:d,type:a.toUpperCase(),status:c};return b.push(e),e},d=c;return o&&(a=f.createElement("ul"),a.id="bootLogger",f.body.appendChild(a),d=function(b,d){var e=c(b,d),g=e.time+"ms : "+e.type+" - "+e.status,h=f.createElement("li");h.innerHTML=g,a.appendChild(h)},a.onclick=function(){a.onclick=null,f.body.removeChild(a)}),d}(),r={},s=function(a){a=a||function(){};var d=1,e=4,f=5,g=function(b){var c=!1;try{k.status===e&&(k.swapCache(),c=!0)}catch(d){b+=" Error"+d.message}a(c,b)},h=function(){c.setTimeout(function(){a(!1,"listenForEvents timed out, status: "+k.status)},1e4),k.addEventListener("progress",function(a){var b=100*(a.loaded&&a.total?a.loaded/a.total:0);b>10&&(i.className="progress-bar",j.style.width=b+"%")},!1),k.addEventListener("updateready",function(){g("event::updateready")},!1),k.addEventListener("noupdate",function(){a(!1,"event::noupdate")},!1),k.addEventListener("obsolete",function(){g("event::obsolete")},!1),k.addEventListener("error",function(){g("event::error")},!1)};if(k&&k.status)if(k.status===d){h();try{k.update()}catch(l){b.splunk.error("boot",l,"applicationCache::update()"),a(!0,"appCache.update() Error: "+l.message)}}else k.status===e?g("status::updateready"):k.status===f?g("status::obsolete"):a&&h();else a(!1,"No appcache or status::uncached "+(k&&k.status))},t=function(a){b.get("app")?b.run(function(){q("APP","Started"),r.dom=(new Date).getTime()-(l+r.backend),b.trigger("timing",b,m+"::boot","app",(new Date).getTime()-l),g.parentNode.removeChild(g),b.view.el.style.display="block"}):(q("APP","Wait for it"),d.delay(t,50,a))};if(!c.mochaPhantomJS&&!c.mocha)return("ios"!==p.platformName||p.platformVersion<7)&&c.scrollTo(0,1),q("APP","Booting..."),r.queue=(new Date).getTime()-l,b.trigger("timing",b,m+"::boot","start",(new Date).getTime()-l),"leo-desktop"===m&&"msie"===p.browserName&&p.browserVersion<8?(q("Load chrome frame"),void b.use("loader",function(a){a.js("https://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js",function(){g.parentNode.removeChild(g),c.CFInstall.check({mode:"inline",destination:c.location.href})})})):void e.parallel({bootstrap:function(a){b.use(["bootstrap"],function(e){e(function(f){q("BOOTSTRAP",f?"Error":"Done"),b.trigger("timing",b,m+"::boot","bootstrap",(new Date).getTime()-l),b.state()===b.STATE_MAINTENANCE||f&&f.message!==b.ERROR.DEPRECATED?(s(),a(f)):(q("APPCACHE","Updating from "+n+" to "+e.data("version")),s(d.once(function(b,d){i.className="progress-bar",j.style.width="100%",q("APPCACHE",(b?"YES":"FALSE")+" - "+d),b?c.setTimeout(function(){c.location.reload()},1e3):a()})))})})},i18n:function(a){b.use(["i18n"],function(c){q("I18N",c.hasMessages()?"Done":"Error"),b.trigger("timing",b,m+"::boot","i18n",(new Date).getTime()-l),a()})},rum:function(a){b.use(["rum"],function(b){a(null,b)})}},function(a,c){a&&b.splunk.error("boot",a,"async::parallel"),r.backend=(new Date).getTime()-l,b.trigger("timing",b,m+"::boot","ready",(new Date).getTime()-l),t(c.rum)})}(this);